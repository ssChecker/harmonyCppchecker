
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [project name]</title>
    <link rel="stylesheet" href="style.css">
    <style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [project name]: kernel/liteos_a/bsd/dev/usb/storage/scsi_all.h</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> scsi_all.h</p>
<a href="34.html#line-147"> cert-API01-C 147</a><a href="34.html#line-155"> cert-API01-C 155</a><a href="34.html#line-167"> cert-API01-C 167</a><a href="34.html#line-195"> cert-API01-C 195</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="cm">/*-</span>
<a name="line-2"></a><span class="cm"> * Largely written by Julian Elischer (julian@tfs.com)</span>
<a name="line-3"></a><span class="cm"> * for TRW Financial Systems.</span>
<a name="line-4"></a><span class="cm"> *</span>
<a name="line-5"></a><span class="cm"> * TRW Financial Systems, in accordance with their agreement with Carnegie</span>
<a name="line-6"></a><span class="cm"> * Mellon University, makes this software available to CMU to distribute</span>
<a name="line-7"></a><span class="cm"> * or use in any manner that they see fit as long as this message is kept with</span>
<a name="line-8"></a><span class="cm"> * the software. For this reason TFS also grants any other persons or</span>
<a name="line-9"></a><span class="cm"> * organisations permission to use or modify this software.</span>
<a name="line-10"></a><span class="cm"> *</span>
<a name="line-11"></a><span class="cm"> * TFS supplies this software to be publicly redistributed</span>
<a name="line-12"></a><span class="cm"> * on the understanding that TFS is not responsible for the correct</span>
<a name="line-13"></a><span class="cm"> * functioning of this software in any circumstances.</span>
<a name="line-14"></a><span class="cm"> *</span>
<a name="line-15"></a><span class="cm"> * Ported to run under 386BSD by Julian Elischer (julian@tfs.com) Sept 1992</span>
<a name="line-16"></a><span class="cm"> *</span>
<a name="line-17"></a><span class="cm"> * $FreeBSD: releng/11.4/sys/cam/scsi/scsi_all.h 351582 2019-08-28 20:23:08Z mav $</span>
<a name="line-18"></a><span class="cm"> */</span>
<a name="line-19"></a>
<a name="line-20"></a><span class="cp">#ifndef __INCLUDE_SCSI_ALL_H</span>
<a name="line-21"></a><span class="cp">#define	__INCLUDE_SCSI_ALL_H</span>
<a name="line-22"></a>
<a name="line-23"></a><span class="cp">#define	SC_SCSI_1 0x01</span>
<a name="line-24"></a><span class="cp">#define	SC_SCSI_2 0x03</span>
<a name="line-25"></a>
<a name="line-26"></a><span class="cp">#define	SCSI_REV_2 0x02</span>
<a name="line-27"></a>
<a name="line-28"></a><span class="cm">/*</span>
<a name="line-29"></a><span class="cm"> * Opcodes</span>
<a name="line-30"></a><span class="cm"> */</span>
<a name="line-31"></a>
<a name="line-32"></a><span class="cp">#define	TEST_UNIT_READY		0x00</span>
<a name="line-33"></a><span class="cp">#define	REQUEST_SENSE		0x03</span>
<a name="line-34"></a><span class="cp">#define	READ_6				0x08</span>
<a name="line-35"></a><span class="cp">#define	WRITE_6				0x0A</span>
<a name="line-36"></a><span class="cp">#define	INQUIRY				0x12</span>
<a name="line-37"></a><span class="cp">#define	MODE_SELECT_6		0x15</span>
<a name="line-38"></a><span class="cp">#define	MODE_SENSE_6		0x1A</span>
<a name="line-39"></a><span class="cp">#define	START_STOP_UNIT		0x1B</span>
<a name="line-40"></a><span class="cp">#define	START_STOP			0x1B</span>
<a name="line-41"></a><span class="cp">#define	RESERVE				0x16</span>
<a name="line-42"></a><span class="cp">#define	RELEASE				0x17</span>
<a name="line-43"></a><span class="cp">#define	RECEIVE_DIAGNOSTIC	0x1C</span>
<a name="line-44"></a><span class="cp">#define	SEND_DIAGNOSTIC		0x1D</span>
<a name="line-45"></a><span class="cp">#define	PREVENT_ALLOW		0x1E</span>
<a name="line-46"></a><span class="cp">#define	READ_CAPACITY		0x25</span>
<a name="line-47"></a><span class="cp">#define	READ_10				0x28</span>
<a name="line-48"></a><span class="cp">#define	WRITE_10			0x2A</span>
<a name="line-49"></a><span class="cp">#define	POSITION_TO_ELEMENT	0x2B</span>
<a name="line-50"></a><span class="cp">#define	WRITE_VERIFY_10		0x2E</span>
<a name="line-51"></a><span class="cp">#define	VERIFY_10			0x2F</span>
<a name="line-52"></a><span class="cp">#define	SYNCHRONIZE_CACHE	0x35</span>
<a name="line-53"></a><span class="cp">#define	READ_DEFECT_DATA_10	0x37</span>
<a name="line-54"></a><span class="cp">#define	WRITE_BUFFER		0x3B</span>
<a name="line-55"></a><span class="cp">#define	READ_BUFFER			0x3C</span>
<a name="line-56"></a><span class="cp">#define	CHANGE_DEFINITION	0x40</span>
<a name="line-57"></a><span class="cp">#define	WRITE_SAME_10		0x41</span>
<a name="line-58"></a><span class="cp">#define	UNMAP				0x42</span>
<a name="line-59"></a><span class="cp">#define	LOG_SELECT			0x4C</span>
<a name="line-60"></a><span class="cp">#define	LOG_SENSE			0x4D</span>
<a name="line-61"></a><span class="cp">#define	MODE_SELECT_10		0x55</span>
<a name="line-62"></a><span class="cp">#define	RESERVE_10			0x56</span>
<a name="line-63"></a><span class="cp">#define	RELEASE_10			0x57</span>
<a name="line-64"></a><span class="cp">#define	MODE_SENSE_10		0x5A</span>
<a name="line-65"></a><span class="cp">#define	PERSISTENT_RES_IN	0x5E</span>
<a name="line-66"></a><span class="cp">#define	PERSISTENT_RES_OUT	0x5F</span>
<a name="line-67"></a><span class="cp">#define	EXTENDED_COPY		0x83</span>
<a name="line-68"></a><span class="cp">#define	RECEIVE_COPY_STATUS	0x84</span>
<a name="line-69"></a><span class="cp">#define	ATA_PASS_16			0x85</span>
<a name="line-70"></a><span class="cp">#define	READ_16				0x88</span>
<a name="line-71"></a><span class="cp">#define	COMPARE_AND_WRITE	0x89</span>
<a name="line-72"></a><span class="cp">#define	WRITE_16			0x8A</span>
<a name="line-73"></a><span class="cp">#define	WRITE_VERIFY_16		0x8E</span>
<a name="line-74"></a><span class="cp">#define	VERIFY_16			0x8F</span>
<a name="line-75"></a><span class="cp">#define	SYNCHRONIZE_CACHE_16	0x91</span>
<a name="line-76"></a><span class="cp">#define	WRITE_SAME_16		0x93</span>
<a name="line-77"></a><span class="cp">#define	SERVICE_ACTION_IN	0x9E</span>
<a name="line-78"></a><span class="cp">#define	REPORT_LUNS			0xA0</span>
<a name="line-79"></a><span class="cp">#define	ATA_PASS_12			0xA1</span>
<a name="line-80"></a><span class="cp">#define	MAINTENANCE_IN		0xA3</span>
<a name="line-81"></a><span class="cp">#define	MAINTENANCE_OUT		0xA4</span>
<a name="line-82"></a><span class="cp">#define	MOVE_MEDIUM			0xA5</span>
<a name="line-83"></a><span class="cp">#define	READ_12				0xA8</span>
<a name="line-84"></a><span class="cp">#define	WRITE_12			0xAA</span>
<a name="line-85"></a><span class="cp">#define	WRITE_VERIFY_12		0xAE</span>
<a name="line-86"></a><span class="cp">#define	VERIFY_12			0xAF</span>
<a name="line-87"></a><span class="cp">#define	READ_ELEMENT_STATUS	0xB8</span>
<a name="line-88"></a><span class="cp">#define	READ_CD				0xBE</span>
<a name="line-89"></a>
<a name="line-90"></a><span class="cm">/* Maintenance In Service Action Codes */</span>
<a name="line-91"></a><span class="cp">#define	REPORT_IDENTIFYING_INFRMATION		0x05</span>
<a name="line-92"></a><span class="cp">#define	REPORT_TARGET_PORT_GROUPS			0x0A</span>
<a name="line-93"></a><span class="cp">#define	REPORT_ALIASES						0x0B</span>
<a name="line-94"></a><span class="cp">#define	REPORT_SUPPORTED_OPERATION_CODES	0x0C</span>
<a name="line-95"></a><span class="cp">#define	REPORT_SUPPORTED_TASK_MANAGEMENT_FUNCTIONS	0x0D</span>
<a name="line-96"></a><span class="cp">#define	REPORT_PRIORITY						0x0E</span>
<a name="line-97"></a><span class="cp">#define	REPORT_TIMESTAMP					0x0F</span>
<a name="line-98"></a><span class="cp">#define	MANAGEMENT_PROTOCOL_IN				0x10</span>
<a name="line-99"></a><span class="cm">/* Maintenance Out Service Action Codes */</span>
<a name="line-100"></a><span class="cp">#define	SET_IDENTIFY_INFORMATION			0x06</span>
<a name="line-101"></a><span class="cp">#define	SET_TARGET_PORT_GROUPS				0x0A</span>
<a name="line-102"></a><span class="cp">#define	CHANGE_ALIASES						0x0B</span>
<a name="line-103"></a><span class="cp">#define	SET_PRIORITY						0x0E</span>
<a name="line-104"></a><span class="cp">#define	SET_TIMESTAMP						0x0F</span>
<a name="line-105"></a><span class="cp">#define	MANGAEMENT_PROTOCOL_OUT				0x10</span>
<a name="line-106"></a>
<a name="line-107"></a><span class="cm">/*</span>
<a name="line-108"></a><span class="cm"> * Device Types</span>
<a name="line-109"></a><span class="cm"> */</span>
<a name="line-110"></a><span class="cp">#define	T_DIRECT	0x00</span>
<a name="line-111"></a><span class="cp">#define	T_SEQUENTIAL	0x01</span>
<a name="line-112"></a><span class="cp">#define	T_PRINTER	0x02</span>
<a name="line-113"></a><span class="cp">#define	T_PROCESSOR	0x03</span>
<a name="line-114"></a><span class="cp">#define	T_WORM		0x04</span>
<a name="line-115"></a><span class="cp">#define	T_CDROM		0x05</span>
<a name="line-116"></a><span class="cp">#define	T_SCANNER	0x06</span>
<a name="line-117"></a><span class="cp">#define	T_OPTICAL	0x07</span>
<a name="line-118"></a><span class="cp">#define	T_CHANGER	0x08</span>
<a name="line-119"></a><span class="cp">#define	T_COMM		0x09</span>
<a name="line-120"></a><span class="cp">#define	T_ASC0		0x0a</span>
<a name="line-121"></a><span class="cp">#define	T_ASC1		0x0b</span>
<a name="line-122"></a><span class="cp">#define	T_STORARRAY	0x0c</span>
<a name="line-123"></a><span class="cp">#define	T_ENCLOSURE	0x0d</span>
<a name="line-124"></a><span class="cp">#define	T_RBC		0x0e</span>
<a name="line-125"></a><span class="cp">#define	T_OCRW		0x0f</span>
<a name="line-126"></a><span class="cp">#define	T_OSD		0x11</span>
<a name="line-127"></a><span class="cp">#define	T_ADC		0x12</span>
<a name="line-128"></a><span class="cp">#define	T_NODEVICE	0x1f</span>
<a name="line-129"></a><span class="cp">#define	T_ANY		0xff	</span><span class="cm">/* Used in Quirk table matches */</span><span class="cp"></span>
<a name="line-130"></a>
<a name="line-131"></a><span class="cp">#define	T_REMOV		1</span>
<a name="line-132"></a><span class="cp">#define	T_FIXED		0</span>
<a name="line-133"></a>
<a name="line-134"></a><span class="cm">/*</span>
<a name="line-135"></a><span class="cm"> * This length is the initial inquiry length used by the probe code, as</span>
<a name="line-136"></a><span class="cm"> * well as the length necessary for scsi_print_inquiry() to function</span>
<a name="line-137"></a><span class="cm"> * correctly.  If either use requires a different length in the future,</span>
<a name="line-138"></a><span class="cm"> * the two values should be de-coupled.</span>
<a name="line-139"></a><span class="cm"> */</span>
<a name="line-140"></a><span class="cp">#define	SHORT_INQUIRY_LENGTH	36</span>
<a name="line-141"></a>
<a name="line-142"></a><span class="k">struct</span> <span class="n">scsi_test_unit_ready</span>
<a name="line-143"></a><span class="p">{</span>
<a name="line-144"></a>	<span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>
<a name="line-145"></a>	<span class="kt">uint8_t</span> <span class="n">byte2</span><span class="p">;</span>
<a name="line-146"></a>	<span class="kt">uint8_t</span> <span class="n">unused</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<a name="line-147"></a><span class="hll">	<span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-148"></a><span class="p">};</span>
<a name="line-149"></a>
<a name="line-150"></a><span class="k">struct</span> <span class="n">scsi_sense</span>
<a name="line-151"></a><span class="p">{</span>
<a name="line-152"></a>	<span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>
<a name="line-153"></a>	<span class="kt">uint8_t</span> <span class="n">byte2</span><span class="p">;</span>
<a name="line-154"></a>	<span class="kt">uint8_t</span> <span class="n">unused</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<a name="line-155"></a><span class="hll">	<span class="kt">uint8_t</span> <span class="n">length</span><span class="p">;</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-156"></a>	<span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>
<a name="line-157"></a><span class="p">};</span>
<a name="line-158"></a>
<a name="line-159"></a><span class="k">struct</span> <span class="n">scsi_inquiry</span>
<a name="line-160"></a><span class="p">{</span>
<a name="line-161"></a>	<span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>
<a name="line-162"></a>	<span class="kt">uint8_t</span> <span class="n">byte2</span><span class="p">;</span>
<a name="line-163"></a><span class="cp">#define	SI_EVPD		0x01</span>
<a name="line-164"></a><span class="cp">#define	SI_CMDDT	0x02</span>
<a name="line-165"></a>	<span class="kt">uint8_t</span> <span class="n">page_code</span><span class="p">;</span>
<a name="line-166"></a>	<span class="kt">uint8_t</span> <span class="n">length</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<a name="line-167"></a><span class="hll">	<span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-168"></a><span class="p">};</span>
<a name="line-169"></a>
<a name="line-170"></a><span class="k">struct</span> <span class="n">scsi_sense_data</span>
<a name="line-171"></a><span class="p">{</span>
<a name="line-172"></a>	<span class="kt">uint8_t</span> <span class="n">error_code</span><span class="p">;</span>
<a name="line-173"></a>	<span class="cm">/*</span>
<a name="line-174"></a><span class="cm">	 * SPC-4 says that the maximum length of sense data is 252 bytes.</span>
<a name="line-175"></a><span class="cm">	 * So this structure is exactly 252 bytes log.</span>
<a name="line-176"></a><span class="cm">	 */</span>
<a name="line-177"></a><span class="cp">#define	SSD_FULL_SIZE 252</span>
<a name="line-178"></a>	<span class="kt">uint8_t</span> <span class="n">sense_buf</span><span class="p">[</span><span class="n">SSD_FULL_SIZE</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
<a name="line-179"></a>	<span class="cm">/*</span>
<a name="line-180"></a><span class="cm">	 * XXX KDM is this still a reasonable minimum size?</span>
<a name="line-181"></a><span class="cm">	 */</span>
<a name="line-182"></a><span class="cp">#define	SSD_MIN_SIZE 18</span>
<a name="line-183"></a>	<span class="cm">/*</span>
<a name="line-184"></a><span class="cm">	 * Maximum value for the extra_len field in the sense data.</span>
<a name="line-185"></a><span class="cm">	 */</span>
<a name="line-186"></a><span class="cp">#define	SSD_EXTRA_MAX 244</span>
<a name="line-187"></a><span class="p">};</span>
<a name="line-188"></a>
<a name="line-189"></a><span class="k">struct</span> <span class="n">scsi_start_stop_unit</span>
<a name="line-190"></a><span class="p">{</span>
<a name="line-191"></a>	<span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>
<a name="line-192"></a>	<span class="kt">uint8_t</span> <span class="n">byte2</span><span class="p">;</span>
<a name="line-193"></a><span class="cp">#define	SSS_IMMED		0x01</span>
<a name="line-194"></a>	<span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<a name="line-195"></a><span class="hll">	<span class="kt">uint8_t</span> <span class="n">how</span><span class="p">;</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-196"></a><span class="cp">#define	SSS_START			0x01</span>
<a name="line-197"></a><span class="cp">#define	SSS_LOEJ			0x02</span>
<a name="line-198"></a><span class="cp">#define	SSS_PC_MASK			0xf0</span>
<a name="line-199"></a><span class="cp">#define	SSS_PC_START_VALID	0x00</span>
<a name="line-200"></a><span class="cp">#define	SSS_PC_ACTIVE		0x10</span>
<a name="line-201"></a><span class="cp">#define	SSS_PC_IDLE			0x20</span>
<a name="line-202"></a><span class="cp">#define	SSS_PC_STANDBY		0x30</span>
<a name="line-203"></a><span class="cp">#define	SSS_PC_LU_CONTROL	0x70</span>
<a name="line-204"></a><span class="cp">#define	SSS_PC_FORCE_IDLE_0	0xa0</span>
<a name="line-205"></a><span class="cp">#define	SSS_PC_FORCE_STANDBY_0	0xb0</span>
<a name="line-206"></a>	<span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>
<a name="line-207"></a><span class="p">};</span>
<a name="line-208"></a>
<a name="line-209"></a><span class="cm">/*</span>
<a name="line-210"></a><span class="cm"> * Opcodes</span>
<a name="line-211"></a><span class="cm"> */</span>
<a name="line-212"></a><span class="cp">#define	VERIFIED			0x2f</span>
<a name="line-213"></a><span class="cp">#define	REZERO_UNIT			0x01</span>
<a name="line-214"></a><span class="cp">#define	FORMAT_UNIT			0x04</span>
<a name="line-215"></a><span class="cp">#define	REASSIGN_BLOCKS		0x07</span>
<a name="line-216"></a><span class="cp">#define	MODE_SELECT			0x15</span>
<a name="line-217"></a><span class="cp">#define	MODE_SENSE			0x1a</span>
<a name="line-218"></a><span class="cp">#define	READ_FORMAT_CAPACITIES	0x23</span>
<a name="line-219"></a><span class="cp">#define	WRITE_AND_VERIFY	0x2e</span>
<a name="line-220"></a><span class="cp">#define	READ_DEFECT_DATA_10	0x37</span>
<a name="line-221"></a><span class="cp">#define	SANITIZE			0x48</span>
<a name="line-222"></a><span class="cp">#define	READ_DEFECT_DATA_12	0xb7</span>
<a name="line-223"></a>
<a name="line-224"></a><span class="cp">#endif</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.1 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
