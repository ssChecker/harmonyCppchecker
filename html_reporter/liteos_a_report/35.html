
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [project name]</title>
    <link rel="stylesheet" href="style.css">
    <style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [project name]: kernel/liteos_a/bsd/dev/usb/storage/scsi.h</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> scsi.h</p>
<a href="35.html#line-645"> cert-API01-C 645</a><a href="35.html#line-657"> cert-API01-C 657</a><a href="35.html#line-659"> cert-API01-C 659</a><a href="35.html#line-673"> cert-API01-C 673</a><a href="35.html#line-701"> cert-API01-C 701</a><a href="35.html#line-721"> cert-API01-C 721</a><a href="35.html#line-750"> cert-API01-C 750</a><a href="35.html#line-780"> cert-API01-C 780</a><a href="35.html#line-783"> cert-API01-C 783</a><a href="35.html#line-794"> cert-API01-C 794</a><a href="35.html#line-804"> cert-API01-C 804</a><a href="35.html#line-824"> cert-API01-C 824</a><a href="35.html#line-834"> cert-API01-C 834</a><a href="35.html#line-843"> cert-API01-C 843</a><a href="35.html#line-848"> cert-API01-C 848</a><a href="35.html#line-857"> cert-API01-C 857</a><a href="35.html#line-868"> cert-API01-C 868</a><a href="35.html#line-886"> cert-API01-C 886</a><a href="35.html#line-895"> cert-API01-C 895</a><a href="35.html#line-906"> cert-API01-C 906</a><a href="35.html#line-917"> cert-API01-C 917</a><a href="35.html#line-927"> cert-API01-C 927</a><a href="35.html#line-929"> cert-API01-C 929</a><a href="35.html#line-938"> cert-API01-C 938</a><a href="35.html#line-940"> cert-API01-C 940</a><a href="35.html#line-949"> cert-API01-C 949</a><a href="35.html#line-951"> cert-API01-C 951</a><a href="35.html#line-960"> cert-API01-C 960</a><a href="35.html#line-962"> cert-API01-C 962</a><a href="35.html#line-972"> cert-API01-C 972</a><a href="35.html#line-979"> cert-API01-C 979</a><a href="35.html#line-994"> cert-API01-C 994</a><a href="35.html#line-1004"> cert-API01-C 1004</a><a href="35.html#line-1015"> cert-API01-C 1015</a><a href="35.html#line-1026"> cert-API01-C 1026</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>   1
   2
   3
   4
   5
   6
   7
   8
   9
  10
  11
  12
  13
  14
  15
  16
  17
  18
  19
  20
  21
  22
  23
  24
  25
  26
  27
  28
  29
  30
  31
  32
  33
  34
  35
  36
  37
  38
  39
  40
  41
  42
  43
  44
  45
  46
  47
  48
  49
  50
  51
  52
  53
  54
  55
  56
  57
  58
  59
  60
  61
  62
  63
  64
  65
  66
  67
  68
  69
  70
  71
  72
  73
  74
  75
  76
  77
  78
  79
  80
  81
  82
  83
  84
  85
  86
  87
  88
  89
  90
  91
  92
  93
  94
  95
  96
  97
  98
  99
 100
 101
 102
 103
 104
 105
 106
 107
 108
 109
 110
 111
 112
 113
 114
 115
 116
 117
 118
 119
 120
 121
 122
 123
 124
 125
 126
 127
 128
 129
 130
 131
 132
 133
 134
 135
 136
 137
 138
 139
 140
 141
 142
 143
 144
 145
 146
 147
 148
 149
 150
 151
 152
 153
 154
 155
 156
 157
 158
 159
 160
 161
 162
 163
 164
 165
 166
 167
 168
 169
 170
 171
 172
 173
 174
 175
 176
 177
 178
 179
 180
 181
 182
 183
 184
 185
 186
 187
 188
 189
 190
 191
 192
 193
 194
 195
 196
 197
 198
 199
 200
 201
 202
 203
 204
 205
 206
 207
 208
 209
 210
 211
 212
 213
 214
 215
 216
 217
 218
 219
 220
 221
 222
 223
 224
 225
 226
 227
 228
 229
 230
 231
 232
 233
 234
 235
 236
 237
 238
 239
 240
 241
 242
 243
 244
 245
 246
 247
 248
 249
 250
 251
 252
 253
 254
 255
 256
 257
 258
 259
 260
 261
 262
 263
 264
 265
 266
 267
 268
 269
 270
 271
 272
 273
 274
 275
 276
 277
 278
 279
 280
 281
 282
 283
 284
 285
 286
 287
 288
 289
 290
 291
 292
 293
 294
 295
 296
 297
 298
 299
 300
 301
 302
 303
 304
 305
 306
 307
 308
 309
 310
 311
 312
 313
 314
 315
 316
 317
 318
 319
 320
 321
 322
 323
 324
 325
 326
 327
 328
 329
 330
 331
 332
 333
 334
 335
 336
 337
 338
 339
 340
 341
 342
 343
 344
 345
 346
 347
 348
 349
 350
 351
 352
 353
 354
 355
 356
 357
 358
 359
 360
 361
 362
 363
 364
 365
 366
 367
 368
 369
 370
 371
 372
 373
 374
 375
 376
 377
 378
 379
 380
 381
 382
 383
 384
 385
 386
 387
 388
 389
 390
 391
 392
 393
 394
 395
 396
 397
 398
 399
 400
 401
 402
 403
 404
 405
 406
 407
 408
 409
 410
 411
 412
 413
 414
 415
 416
 417
 418
 419
 420
 421
 422
 423
 424
 425
 426
 427
 428
 429
 430
 431
 432
 433
 434
 435
 436
 437
 438
 439
 440
 441
 442
 443
 444
 445
 446
 447
 448
 449
 450
 451
 452
 453
 454
 455
 456
 457
 458
 459
 460
 461
 462
 463
 464
 465
 466
 467
 468
 469
 470
 471
 472
 473
 474
 475
 476
 477
 478
 479
 480
 481
 482
 483
 484
 485
 486
 487
 488
 489
 490
 491
 492
 493
 494
 495
 496
 497
 498
 499
 500
 501
 502
 503
 504
 505
 506
 507
 508
 509
 510
 511
 512
 513
 514
 515
 516
 517
 518
 519
 520
 521
 522
 523
 524
 525
 526
 527
 528
 529
 530
 531
 532
 533
 534
 535
 536
 537
 538
 539
 540
 541
 542
 543
 544
 545
 546
 547
 548
 549
 550
 551
 552
 553
 554
 555
 556
 557
 558
 559
 560
 561
 562
 563
 564
 565
 566
 567
 568
 569
 570
 571
 572
 573
 574
 575
 576
 577
 578
 579
 580
 581
 582
 583
 584
 585
 586
 587
 588
 589
 590
 591
 592
 593
 594
 595
 596
 597
 598
 599
 600
 601
 602
 603
 604
 605
 606
 607
 608
 609
 610
 611
 612
 613
 614
 615
 616
 617
 618
 619
 620
 621
 622
 623
 624
 625
 626
 627
 628
 629
 630
 631
 632
 633
 634
 635
 636
 637
 638
 639
 640
 641
 642
 643
 644
 645
 646
 647
 648
 649
 650
 651
 652
 653
 654
 655
 656
 657
 658
 659
 660
 661
 662
 663
 664
 665
 666
 667
 668
 669
 670
 671
 672
 673
 674
 675
 676
 677
 678
 679
 680
 681
 682
 683
 684
 685
 686
 687
 688
 689
 690
 691
 692
 693
 694
 695
 696
 697
 698
 699
 700
 701
 702
 703
 704
 705
 706
 707
 708
 709
 710
 711
 712
 713
 714
 715
 716
 717
 718
 719
 720
 721
 722
 723
 724
 725
 726
 727
 728
 729
 730
 731
 732
 733
 734
 735
 736
 737
 738
 739
 740
 741
 742
 743
 744
 745
 746
 747
 748
 749
 750
 751
 752
 753
 754
 755
 756
 757
 758
 759
 760
 761
 762
 763
 764
 765
 766
 767
 768
 769
 770
 771
 772
 773
 774
 775
 776
 777
 778
 779
 780
 781
 782
 783
 784
 785
 786
 787
 788
 789
 790
 791
 792
 793
 794
 795
 796
 797
 798
 799
 800
 801
 802
 803
 804
 805
 806
 807
 808
 809
 810
 811
 812
 813
 814
 815
 816
 817
 818
 819
 820
 821
 822
 823
 824
 825
 826
 827
 828
 829
 830
 831
 832
 833
 834
 835
 836
 837
 838
 839
 840
 841
 842
 843
 844
 845
 846
 847
 848
 849
 850
 851
 852
 853
 854
 855
 856
 857
 858
 859
 860
 861
 862
 863
 864
 865
 866
 867
 868
 869
 870
 871
 872
 873
 874
 875
 876
 877
 878
 879
 880
 881
 882
 883
 884
 885
 886
 887
 888
 889
 890
 891
 892
 893
 894
 895
 896
 897
 898
 899
 900
 901
 902
 903
 904
 905
 906
 907
 908
 909
 910
 911
 912
 913
 914
 915
 916
 917
 918
 919
 920
 921
 922
 923
 924
 925
 926
 927
 928
 929
 930
 931
 932
 933
 934
 935
 936
 937
 938
 939
 940
 941
 942
 943
 944
 945
 946
 947
 948
 949
 950
 951
 952
 953
 954
 955
 956
 957
 958
 959
 960
 961
 962
 963
 964
 965
 966
 967
 968
 969
 970
 971
 972
 973
 974
 975
 976
 977
 978
 979
 980
 981
 982
 983
 984
 985
 986
 987
 988
 989
 990
 991
 992
 993
 994
 995
 996
 997
 998
 999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="cm">/****************************************************************************</span>
<a name="line-2"></a><span class="cm"> * include/nuttx/scsi.h</span>
<a name="line-3"></a><span class="cm"> *</span>
<a name="line-4"></a><span class="cm"> *   Copyright (C) 2008, 2009 Gregory Nutt. All rights reserved.</span>
<a name="line-5"></a><span class="cm"> *   Author: Gregory Nutt &lt;gnutt@nuttx.org&gt;</span>
<a name="line-6"></a><span class="cm"> *</span>
<a name="line-7"></a><span class="cm"> * References:</span>
<a name="line-8"></a><span class="cm"> *   &quot;SCSI Primary Commands - 3 (SPC-3),&quot;  American National Standard</span>
<a name="line-9"></a><span class="cm"> *   for Information Technology, May 4, 2005</span>
<a name="line-10"></a><span class="cm"> *</span>
<a name="line-11"></a><span class="cm"> *   &quot;SCSI Primary Commands - 4 (SPC-4),&quot;  American National Standard</span>
<a name="line-12"></a><span class="cm"> *   for Information Technology, July 19, 2008</span>
<a name="line-13"></a><span class="cm"> *</span>
<a name="line-14"></a><span class="cm"> *   &quot;SCSI Block Commands -2 (SBC-2),&quot; American National Standard</span>
<a name="line-15"></a><span class="cm"> *   for Information Technology, November 13, 2004</span>
<a name="line-16"></a><span class="cm"> *</span>
<a name="line-17"></a><span class="cm"> *   &quot;SCSI Multimedia Commands - 3 (MMC-3),&quot;  American National Standard</span>
<a name="line-18"></a><span class="cm"> *   for Information Technology, November 12, 2001</span>
<a name="line-19"></a><span class="cm"> *</span>
<a name="line-20"></a><span class="cm"> * Redistribution and use in source and binary forms, with or without</span>
<a name="line-21"></a><span class="cm"> * modification, are permitted provided that the following conditions</span>
<a name="line-22"></a><span class="cm"> * are met:</span>
<a name="line-23"></a><span class="cm"> *</span>
<a name="line-24"></a><span class="cm"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="line-25"></a><span class="cm"> *    notice, this list of conditions and the following disclaimer.</span>
<a name="line-26"></a><span class="cm"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="line-27"></a><span class="cm"> *    notice, this list of conditions and the following disclaimer in</span>
<a name="line-28"></a><span class="cm"> *    the documentation and/or other materials provided with the</span>
<a name="line-29"></a><span class="cm"> *    distribution.</span>
<a name="line-30"></a><span class="cm"> * 3. Neither the name NuttX nor the names of its contributors may be</span>
<a name="line-31"></a><span class="cm"> *    used to endorse or promote products derived from this software</span>
<a name="line-32"></a><span class="cm"> *    without specific prior written permission.</span>
<a name="line-33"></a><span class="cm"> *</span>
<a name="line-34"></a><span class="cm"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="line-35"></a><span class="cm"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="line-36"></a><span class="cm"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS</span>
<a name="line-37"></a><span class="cm"> * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE</span>
<a name="line-38"></a><span class="cm"> * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,</span>
<a name="line-39"></a><span class="cm"> * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,</span>
<a name="line-40"></a><span class="cm"> * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS</span>
<a name="line-41"></a><span class="cm"> * OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED</span>
<a name="line-42"></a><span class="cm"> * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
<a name="line-43"></a><span class="cm"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN</span>
<a name="line-44"></a><span class="cm"> * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<a name="line-45"></a><span class="cm"> * POSSIBILITY OF SUCH DAMAGE.</span>
<a name="line-46"></a><span class="cm"> *</span>
<a name="line-47"></a><span class="cm"> ****************************************************************************/</span>
<a name="line-48"></a>
<a name="line-49"></a><span class="cp">#ifndef __INCLUDE_NUTTX_SCSI_H</span>
<a name="line-50"></a><span class="cp">#define __INCLUDE_NUTTX_SCSI_H</span>
<a name="line-51"></a>
<a name="line-52"></a><span class="cm">/****************************************************************************</span>
<a name="line-53"></a><span class="cm"> * Included Files</span>
<a name="line-54"></a><span class="cm"> ****************************************************************************/</span>
<a name="line-55"></a>
<a name="line-56"></a><span class="cm">/****************************************************************************</span>
<a name="line-57"></a><span class="cm"> * Pre-processor Definitions</span>
<a name="line-58"></a><span class="cm"> ****************************************************************************/</span>
<a name="line-59"></a>
<a name="line-60"></a><span class="cm">/* SCSI commands ************************************************************/</span>
<a name="line-61"></a>
<a name="line-62"></a><span class="cp">#define SCSI_CMD_TESTUNITREADY                   0x00</span>
<a name="line-63"></a><span class="cp">#define SCSI_CMD_REZEROUNIT                      0x01</span>
<a name="line-64"></a><span class="cp">#define SCSI_CMD_REQUESTSENSE                    0x03</span>
<a name="line-65"></a><span class="cp">#define SCSI_CMD_FORMAT_UNIT                     0x04</span>
<a name="line-66"></a><span class="cp">#define SCSI_CMD_REASSIGNBLOCKS                  0x07</span>
<a name="line-67"></a><span class="cp">#define SCSI_CMD_READ6                           0x08</span>
<a name="line-68"></a><span class="cp">#define SCSI_CMD_WRITE6                          0x0a</span>
<a name="line-69"></a><span class="cp">#define SCSI_CMD_SEEK6                           0x0b</span>
<a name="line-70"></a><span class="cp">#define SCSI_CMD_SPACE6                          0x11</span>
<a name="line-71"></a><span class="cp">#define SCSI_CMD_INQUIRY                         0x12</span>
<a name="line-72"></a><span class="cp">#define SCSI_CMD_MODESELECT6                     0x15</span>
<a name="line-73"></a><span class="cp">#define SCSI_CMD_RESERVE6                        0x16</span>
<a name="line-74"></a><span class="cp">#define SCSI_CMD_RELEASE6                        0x17</span>
<a name="line-75"></a><span class="cp">#define SCSI_CMD_COPY                            0x18</span>
<a name="line-76"></a><span class="cp">#define SCSI_CMD_MODESENSE6                      0x1a</span>
<a name="line-77"></a><span class="cp">#define SCSI_CMD_STARTSTOPUNIT                   0x1b</span>
<a name="line-78"></a><span class="cp">#define SCSI_CMD_RECEIVEDIAGNOSTICRESULTS        0x1c</span>
<a name="line-79"></a><span class="cp">#define SCSI_CMD_SENDDIAGNOSTIC                  0x1d</span>
<a name="line-80"></a><span class="cp">#define SCSI_CMD_PREVENTMEDIAREMOVAL             0x1e</span>
<a name="line-81"></a><span class="cp">#define SCSI_CMD_READFORMATCAPACITIES            0x23</span>
<a name="line-82"></a><span class="cp">#define SCSI_CMD_READCAPACITY10                  0x25</span>
<a name="line-83"></a><span class="cp">#define SCSI_CMD_READ10                          0x28</span>
<a name="line-84"></a><span class="cp">#define SCSI_CMD_WRITE10                         0x2a</span>
<a name="line-85"></a><span class="cp">#define SCSI_CMD_READ16                          0x88</span>
<a name="line-86"></a><span class="cp">#define SCSI_CMD_WRITE16                         0x8a</span>
<a name="line-87"></a><span class="cp">#define SCSI_CMD_SEEK10                          0x2b</span>
<a name="line-88"></a><span class="cp">#define SCSI_CMD_WRITEANDVERIFY                  0x2e</span>
<a name="line-89"></a><span class="cp">#define SCSI_CMD_VERIFY10                        0x2f</span>
<a name="line-90"></a><span class="cp">#define SCSI_CMD_SEARCHDATAHIGH                  0x30</span>
<a name="line-91"></a><span class="cp">#define SCSI_CMD_SEARCHDATAEQUAL                 0x31</span>
<a name="line-92"></a><span class="cp">#define SCSI_CMD_SEARCHDATALOW                   0x32</span>
<a name="line-93"></a><span class="cp">#define SCSI_CMD_SETLIMITS10                     0x33</span>
<a name="line-94"></a><span class="cp">#define SCSI_CMD_PREFETCH10                      0x34</span>
<a name="line-95"></a><span class="cp">#define SCSI_CMD_SYNCHCACHE10                    0x35</span>
<a name="line-96"></a><span class="cp">#define SCSI_CMD_LOCKCACHE                       0x36</span>
<a name="line-97"></a><span class="cp">#define SCSI_CMD_READDEFECTDATA10                0x37</span>
<a name="line-98"></a><span class="cp">#define SCSI_CMD_COMPARE                         0x39</span>
<a name="line-99"></a><span class="cp">#define SCSI_CMD_COPYANDVERIFY                   0x3a</span>
<a name="line-100"></a><span class="cp">#define SCSI_CMD_WRITEBUFFER                     0x3b</span>
<a name="line-101"></a><span class="cp">#define SCSI_CMD_READBUFFER                      0x3c</span>
<a name="line-102"></a><span class="cp">#define SCSI_CMD_READLONG10                      0x3e</span>
<a name="line-103"></a><span class="cp">#define SCSI_CMD_WRITELONG10                     0x3f</span>
<a name="line-104"></a><span class="cp">#define SCSI_CMD_CHANGEDEFINITION                0x40</span>
<a name="line-105"></a><span class="cp">#define SCSI_CMD_WRITESAME10                     0x41</span>
<a name="line-106"></a><span class="cp">#define SCSI_CMD_LOGSELECT                       0x4c</span>
<a name="line-107"></a><span class="cp">#define SCSI_CMD_LOGSENSE                        0x4d</span>
<a name="line-108"></a><span class="cp">#define SCSI_CMD_XDWRITE10                       0x50</span>
<a name="line-109"></a><span class="cp">#define SCSI_CMD_XPWRITE10                       0x51</span>
<a name="line-110"></a><span class="cp">#define SCSI_CMD_XDREAD10                        0x52</span>
<a name="line-111"></a><span class="cp">#define SCSI_CMD_MODESELECT10                    0x55</span>
<a name="line-112"></a><span class="cp">#define SCSI_CMD_RESERVE10                       0x56</span>
<a name="line-113"></a><span class="cp">#define SCSI_CMD_RELEASE10                       0x57</span>
<a name="line-114"></a><span class="cp">#define SCSI_CMD_MODESENSE10                     0x5a</span>
<a name="line-115"></a><span class="cp">#define SCSI_CMD_PERSISTENTRESERVEIN             0x5e</span>
<a name="line-116"></a><span class="cp">#define SCSI_CMD_PERSISTENTRESERVEOUT            0x5f</span>
<a name="line-117"></a><span class="cp">#define SCSI_CMD_32                              0x7f</span>
<a name="line-118"></a><span class="cp">#define SCSI_CMD_XDWRITEEXTENDED                 0x80</span>
<a name="line-119"></a><span class="cp">#define SCSI_CMD_REBUILD                         0x82</span>
<a name="line-120"></a><span class="cp">#define SCSI_CMD_REGENERATE                      0x82</span>
<a name="line-121"></a><span class="cp">#define SCSI_CMD_EXTENDEDCOPY                    0x83</span>
<a name="line-122"></a><span class="cp">#define SCSI_CMD_COPYRESULTS                     0x84</span>
<a name="line-123"></a><span class="cp">#define SCSI_CMD_ACCESSCONTROLIN                 0x86</span>
<a name="line-124"></a><span class="cp">#define SCSI_CMD_ACCESSCONTROLOUT                0x87</span>
<a name="line-125"></a><span class="cp">#define SCSI_CMD_READ16                          0x88</span>
<a name="line-126"></a><span class="cp">#define SCSI_CMD_WRITE16                         0x8a</span>
<a name="line-127"></a><span class="cp">#define SCSI_CMD_READATTRIBUTE                   0x8c</span>
<a name="line-128"></a><span class="cp">#define SCSI_CMD_WRITEATTRIBUTE                  0x8d</span>
<a name="line-129"></a><span class="cp">#define SCSI_CMD_WRITEANDVERIFY16                0x8e</span>
<a name="line-130"></a><span class="cp">#define SCSI_CMD_PREFETCH16                      0x90</span>
<a name="line-131"></a><span class="cp">#define SCSI_CMD_SYNCHCACHE16                    0x91</span>
<a name="line-132"></a><span class="cp">#define SCSI_CMD_LOCKUNLOCKACACHE                0x92</span>
<a name="line-133"></a><span class="cp">#define SCSI_CMD_WRITESAME16                     0x93</span>
<a name="line-134"></a><span class="cp">#define SCSI_CMD_READCAPACITY16                  0x9e</span>
<a name="line-135"></a><span class="cp">#define SCSI_CMD_READLONG16                      0x9e</span>
<a name="line-136"></a><span class="cp">#define SCSI_CMD_WRITELONG106                    0x9f</span>
<a name="line-137"></a><span class="cp">#define SCSI_CMD_REPORTLUNS                      0xa0</span>
<a name="line-138"></a><span class="cp">#define SCSI_CMD_MAINTENANCEIN                   0xa3</span>
<a name="line-139"></a><span class="cp">#define SCSI_CMD_MAINTENANCEOUT                  0xa4</span>
<a name="line-140"></a><span class="cp">#define SCSI_CMD_MOVEMEDIUM                      0xa5</span>
<a name="line-141"></a><span class="cp">#define SCSI_CMD_MOVEMEDIUMATTACHED              0xa7</span>
<a name="line-142"></a><span class="cp">#define SCSI_CMD_READ12                          0xa8</span>
<a name="line-143"></a><span class="cp">#define SCSI_CMD_WRITE12                         0xaa</span>
<a name="line-144"></a><span class="cp">#define SCSI_CMD_READMEDIASERIALNUMBER           0xab</span>
<a name="line-145"></a><span class="cp">#define SCSI_CMD_WRITEANDVERIFY12                0xae</span>
<a name="line-146"></a><span class="cp">#define SCSI_CMD_VERIFY12                        0xaf</span>
<a name="line-147"></a><span class="cp">#define SCSI_CMD_SETLIMITS12                     0xb3</span>
<a name="line-148"></a><span class="cp">#define SCSI_CMD_READELEMENTSTATUS               0xb4</span>
<a name="line-149"></a><span class="cp">#define SCSI_CMD_READDEFECTDATA12                0xb7</span>
<a name="line-150"></a><span class="cp">#define SCSI_CMD_REDUNDANCYGROUPIN               0xba</span>
<a name="line-151"></a><span class="cp">#define SCSI_CMD_REDUNDANCYGROUPOUT              0xbb</span>
<a name="line-152"></a><span class="cp">#define SCSI_CMD_SPAREIN                         0xbc</span>
<a name="line-153"></a><span class="cp">#define SCSI_CMD_SPAREOUT                        0xbd</span>
<a name="line-154"></a><span class="cp">#define SCSI_CMD_VOLUMESETIN                     0xbe</span>
<a name="line-155"></a><span class="cp">#define SCSI_CMD_VOLUMESETOUT                    0xbf</span>
<a name="line-156"></a>
<a name="line-157"></a><span class="cm">/* Common SCSI KCQ values (sense Key/additional sense Code/ASC Qualifier) ***</span>
<a name="line-158"></a><span class="cm"> *</span>
<a name="line-159"></a><span class="cm"> *   0xnn0386  Write Fault Data Corruption</span>
<a name="line-160"></a><span class="cm"> *   0xnn0500  Illegal request</span>
<a name="line-161"></a><span class="cm"> *   0xnn0600  Unit attention</span>
<a name="line-162"></a><span class="cm"> *   0xnn0700  Data protect</span>
<a name="line-163"></a><span class="cm"> *   0xnn0800  LUN communication failure</span>
<a name="line-164"></a><span class="cm"> *   0xnn0801  LUN communication timeout</span>
<a name="line-165"></a><span class="cm"> *   0xnn0802  LUN communication parity error</span>
<a name="line-166"></a><span class="cm"> *   0xnn0803  LUN communication CRC error</span>
<a name="line-167"></a><span class="cm"> *   0xnn0900  vendor specific sense key</span>
<a name="line-168"></a><span class="cm"> *   0xnn0901  servo fault</span>
<a name="line-169"></a><span class="cm"> *   0xnn0904  head select fault</span>
<a name="line-170"></a><span class="cm"> *   0xnn0a00  error log overflow</span>
<a name="line-171"></a><span class="cm"> *   0xnn0b00  aborted command</span>
<a name="line-172"></a><span class="cm"> *   0xnn0c00  write error</span>
<a name="line-173"></a><span class="cm"> *   0xnn0c02  write error - auto-realloc failed</span>
<a name="line-174"></a><span class="cm"> *   0xnn0e00  data miscompare</span>
<a name="line-175"></a><span class="cm"> *   0xnn1200  address mark not founf for ID field</span>
<a name="line-176"></a><span class="cm"> *   0xnn1400  logical block not found</span>
<a name="line-177"></a><span class="cm"> *   0xnn1500  random positioning error</span>
<a name="line-178"></a><span class="cm"> *   0xnn1501  mechanical positioning error</span>
<a name="line-179"></a><span class="cm"> *   0xnn1502  positioning error detected by read of medium</span>
<a name="line-180"></a><span class="cm"> *   0xnn2700  write protected</span>
<a name="line-181"></a><span class="cm"> *   0xnn2900  POR or bus reset occurred</span>
<a name="line-182"></a><span class="cm"> *   0xnn3101  format failed</span>
<a name="line-183"></a><span class="cm"> *   0xnn3191  format corrupted</span>
<a name="line-184"></a><span class="cm"> *   0xnn3201  defect list update error</span>
<a name="line-185"></a><span class="cm"> *   0xnn3202  no spares available</span>
<a name="line-186"></a><span class="cm"> *   0xnn3501  unspecified enclosure services failure</span>
<a name="line-187"></a><span class="cm"> *   0xnn3700  parameter rounded</span>
<a name="line-188"></a><span class="cm"> *   0xnn3d00  invalid bits in identify message</span>
<a name="line-189"></a><span class="cm"> *   0xnn3e00  LUN not self-configured yet</span>
<a name="line-190"></a><span class="cm"> *   0xnn4001  DRAM parity error</span>
<a name="line-191"></a><span class="cm"> *   0xnn4002  DRAM parity error</span>
<a name="line-192"></a><span class="cm"> *   0xnn4200  power-on or self-test failure</span>
<a name="line-193"></a><span class="cm"> *   0xnn4c00  LUN failed self-configuration</span>
<a name="line-194"></a><span class="cm"> *   0xnn5c00  RPL status change</span>
<a name="line-195"></a><span class="cm"> *   0xnn5c01  spindles synchronized</span>
<a name="line-196"></a><span class="cm"> *   0xnn5c02  spindles not synchronized</span>
<a name="line-197"></a><span class="cm"> *   0xnn6500  voltage fault</span>
<a name="line-198"></a><span class="cm"> *   0xnn8000  general firmware error</span>
<a name="line-199"></a><span class="cm"> */</span>
<a name="line-200"></a>
<a name="line-201"></a><span class="cm">/* No sense KCQ values */</span>
<a name="line-202"></a>
<a name="line-203"></a><span class="cp">#define SCSI_KCQ_NOSENSE                         0x000000  </span><span class="cm">/* No error */</span><span class="cp"></span>
<a name="line-204"></a><span class="cp">#define SCSI_KCQ_PFATHRESHOLDREACHED             0x005c00  </span><span class="cm">/* No sense - PFA threshold reached */</span><span class="cp"></span>
<a name="line-205"></a>
<a name="line-206"></a><span class="cm">/* Soft error KCQ values */</span>
<a name="line-207"></a>
<a name="line-208"></a><span class="cp">#define SCSI_KCQSE_RWENOINDEX                    0x010100  </span><span class="cm">/* Recovered Write error - no index */</span><span class="cp"></span>
<a name="line-209"></a><span class="cp">#define SCSI_KCQSE_RECOVEREDNOSEEKCOMPLETION     0x010200  </span><span class="cm">/* Recovered no seek completion */</span><span class="cp"></span>
<a name="line-210"></a><span class="cp">#define SCSI_KCQSE_RWEWRITEFAULT                 0x010300  </span><span class="cm">/* Recovered Write error - write fault */</span><span class="cp"></span>
<a name="line-211"></a><span class="cp">#define SCSI_KCQSE_TRACKFOLLOWINGERROR           0x010900  </span><span class="cm">/* Track following error */</span><span class="cp"></span>
<a name="line-212"></a><span class="cp">#define SCSI_KCQSE_TEMPERATUREWARNING            0x010b01  </span><span class="cm">/* Temperature warning */</span><span class="cp"></span>
<a name="line-213"></a><span class="cp">#define SCSI_KCQSE_RWEWARREALLOCATED             0x010c01  </span><span class="cm">/* Recovered Write error with auto-realloc - reallocated */</span><span class="cp"></span>
<a name="line-214"></a><span class="cp">#define SCSI_KCQSE_RWERECOMMENDREASSIGN          0x010c03  </span><span class="cm">/* Recovered Write error - recommend reassign */</span><span class="cp"></span>
<a name="line-215"></a><span class="cp">#define SCSI_KCQSE_RDWOEUSINGPREVLBI             0x011201  </span><span class="cm">/* Recovered data without ECC using prev logical block ID */</span><span class="cp"></span>
<a name="line-216"></a><span class="cp">#define SCSI_KCQSE_RDWEUSINGPREVLBI              0x011202  </span><span class="cm">/* Recovered data with ECC using prev logical block ID */</span><span class="cp"></span>
<a name="line-217"></a><span class="cp">#define SCSI_KCQSE_RECOVEREDRECORDNOTFOUND       0x011401  </span><span class="cm">/* Recovered Record Not Found */</span><span class="cp"></span>
<a name="line-218"></a><span class="cp">#define SCSI_KCQSE_RWEDSME                       0x011600  </span><span class="cm">/* Recovered Write error - Data Sync Mark Error */</span><span class="cp"></span>
<a name="line-219"></a><span class="cp">#define SCSI_KCQSE_RWEDSEDATAREWRITTEN           0x011601  </span><span class="cm">/* Recovered Write error - Data Sync Error - data rewritten */</span><span class="cp"></span>
<a name="line-220"></a><span class="cp">#define SCSI_KCQSE_RWEDSERECOMMENDREWRITE        0x011602  </span><span class="cm">/* Recovered Write error - Data Sync Error - recommend rewrite */</span><span class="cp"></span>
<a name="line-221"></a><span class="cp">#define SCSI_KCQSE_RWEDSEDATAAUTOREALLOCATED     0x011603  </span><span class="cm">/* Recovered Write error - Data Sync Error - data auto-reallocated */</span><span class="cp"></span>
<a name="line-222"></a><span class="cp">#define SCSI_KCQSE_RWEDSERECOMMENDREASSIGNMENT   0x011604  </span><span class="cm">/* Recovered Write error - Data Sync Error - recommend reassignment */</span><span class="cp"></span>
<a name="line-223"></a><span class="cp">#define SCSI_KCQSE_RDWNECORRECTIONAPPLIED        0x011700  </span><span class="cm">/* Recovered data with no error correction applied */</span><span class="cp"></span>
<a name="line-224"></a><span class="cp">#define SCSI_KCQSE_RREWITHRETRIES                0x011701  </span><span class="cm">/* Recovered Read error - with retries */</span><span class="cp"></span>
<a name="line-225"></a><span class="cp">#define SCSI_KCQSE_RDUSINGPOSITIVEOFFSET         0x011702  </span><span class="cm">/* Recovered data using positive offset */</span><span class="cp"></span>
<a name="line-226"></a><span class="cp">#define SCSI_KCQSE_RDUSINGNEGATIVEOFFSET         0x011703  </span><span class="cm">/* Recovered data using negative offset */</span><span class="cp"></span>
<a name="line-227"></a><span class="cp">#define SCSI_KCQSE_RDUSINGPREVIOUSLBI            0x011705  </span><span class="cm">/* Recovered data using previous logical block ID */</span><span class="cp"></span>
<a name="line-228"></a><span class="cp">#define SCSI_KCQSE_RREWOEAUTOREALLOCATED         0x011706  </span><span class="cm">/* Recovered Read error - without ECC, auto reallocated */</span><span class="cp"></span>
<a name="line-229"></a><span class="cp">#define SCSI_KCQSE_RREWOERECOMMENDREASSIGN       0x011707  </span><span class="cm">/* Recovered Read error - without ECC, recommend reassign */</span><span class="cp"></span>
<a name="line-230"></a><span class="cp">#define SCSI_KCQSE_RREWOERECOMMENDREWRITE        0x011708  </span><span class="cm">/* Recovered Read error - without ECC, recommend rewrite */</span><span class="cp"></span>
<a name="line-231"></a><span class="cp">#define SCSI_KCQSE_RREWOEDATAREWRITTEN           0x011709  </span><span class="cm">/* Recovered Read error - without ECC, data rewritten */</span><span class="cp"></span>
<a name="line-232"></a><span class="cp">#define SCSI_KCQSE_RREWE                         0x011800  </span><span class="cm">/* Recovered Read error - with ECC */</span><span class="cp"></span>
<a name="line-233"></a><span class="cp">#define SCSI_KCQSE_RDWEANDRETRIES                0x011801  </span><span class="cm">/* Recovered data with ECC and retries */</span><span class="cp"></span>
<a name="line-234"></a><span class="cp">#define SCSI_KCQSE_RREWEAUTOREALLOCATED          0x011802  </span><span class="cm">/* Recovered Read error - with ECC, auto reallocated */</span><span class="cp"></span>
<a name="line-235"></a><span class="cp">#define SCSI_KCQSE_RREWERECOMMENDREASSIGN        0x011805  </span><span class="cm">/* Recovered Read error - with ECC, recommend reassign */</span><span class="cp"></span>
<a name="line-236"></a><span class="cp">#define SCSI_KCQSE_RDUSINGECCANDOFFSETS          0x011806  </span><span class="cm">/* Recovered data using ECC and offsets */</span><span class="cp"></span>
<a name="line-237"></a><span class="cp">#define SCSI_KCQSE_RREWEDATAREWRITTEN            0x011807  </span><span class="cm">/* Recovered Read error - with ECC, data rewritten */</span><span class="cp"></span>
<a name="line-238"></a><span class="cp">#define SCSI_KCQSE_DLNOTFOUND                    0x011c00  </span><span class="cm">/* Defect List not found */</span><span class="cp"></span>
<a name="line-239"></a><span class="cp">#define SCSI_KCQSE_PRIMARYDLNOTFOUND             0x011c01  </span><span class="cm">/* Primary defect list not found */</span><span class="cp"></span>
<a name="line-240"></a><span class="cp">#define SCSI_KCQSE_GROWNDLNOTFOUND               0x011c02  </span><span class="cm">/* Grown defect list not found */</span><span class="cp"></span>
<a name="line-241"></a><span class="cp">#define SCSI_KCQSE_PARTIALDLTRANSFERRED          0x011f00  </span><span class="cm">/* Partial defect list transferred */</span><span class="cp"></span>
<a name="line-242"></a><span class="cp">#define SCSI_KCQSE_INTERNALTARGETFAILURE         0x014400  </span><span class="cm">/* Internal target failure */</span><span class="cp"></span>
<a name="line-243"></a><span class="cp">#define SCSI_KCQSE_PFATHRESHOLDREACHED           0x015d00  </span><span class="cm">/* PFA threshold reached */</span><span class="cp"></span>
<a name="line-244"></a><span class="cp">#define SCSI_KCQSE_PFATESTWARNING                0x015dff  </span><span class="cm">/* PFA test warning */</span><span class="cp"></span>
<a name="line-245"></a><span class="cp">#define SCSI_KCQSE_INTERNALLOGICFAILURE          0x018100  </span><span class="cm">/* Internal logic failure */</span><span class="cp"></span>
<a name="line-246"></a>
<a name="line-247"></a><span class="cm">/* Not Ready / Diagnostic Failure KCQ values */</span>
<a name="line-248"></a>
<a name="line-249"></a><span class="cp">#define SCSI_KCQNR_CAUSENOTREPORTABLE            0x020400  </span><span class="cm">/* Not Ready - Cause not reportable. */</span><span class="cp"></span>
<a name="line-250"></a><span class="cp">#define SCSI_KCQNR_BECOMINGREADY                 0x020401  </span><span class="cm">/* Not Ready - becoming ready */</span><span class="cp"></span>
<a name="line-251"></a><span class="cp">#define SCSI_KCQNR_NEEDINITIALIZECOMMAND         0x020402  </span><span class="cm">/* Not Ready - need initialize command (start unit) */</span><span class="cp"></span>
<a name="line-252"></a><span class="cp">#define SCSI_KCQNR_MANUALINTERVENTIONREQUIRED    0x020403  </span><span class="cm">/* Not Ready - manual intervention required */</span><span class="cp"></span>
<a name="line-253"></a><span class="cp">#define SCSI_KCQNR_FORMATINPROGRESS              0x020404  </span><span class="cm">/* Not Ready - format in progress */</span><span class="cp"></span>
<a name="line-254"></a><span class="cp">#define SCSI_KCQNR_SELFTESTINPROGRESS            0x020409  </span><span class="cm">/* Not Ready - self-test in progress */</span><span class="cp"></span>
<a name="line-255"></a><span class="cp">#define SCSI_KCQNR_MEDIUMFORMATCORRUPTED         0x023100  </span><span class="cm">/* Not Ready - medium format corrupted */</span><span class="cp"></span>
<a name="line-256"></a><span class="cp">#define SCSI_KCQNR_FORMATCOMMANDFAILED           0x023101  </span><span class="cm">/* Not Ready - format command failed */</span><span class="cp"></span>
<a name="line-257"></a><span class="cp">#define SCSI_KCQNR_ESUNAVAILABLE                 0x023502  </span><span class="cm">/* Not Ready - enclosure services unavailable */</span><span class="cp"></span>
<a name="line-258"></a><span class="cp">#define SCSI_KCQNR_MEDIANOTPRESENT               0x023a00  </span><span class="cm">/* Not Ready - media not present */</span><span class="cp"></span>
<a name="line-259"></a><span class="cp">#define SCSI_KCQDF_BRINGUPFAILORDEGRADEDMODE     0x024080  </span><span class="cm">/* Diagnostic Failure - bring-up fail or degraded mode */</span><span class="cp"></span>
<a name="line-260"></a><span class="cp">#define SCSI_KCQDF_HARDDISKCONTROLLER            0x024081  </span><span class="cm">/* Diagnostic Failure - Hard Disk Controller */</span><span class="cp"></span>
<a name="line-261"></a><span class="cp">#define SCSI_KCQDF_RAMMICROCODENOTLOADED         0x024085  </span><span class="cm">/* Diagnostic Failure - RAM microcode not loaded */</span><span class="cp"></span>
<a name="line-262"></a><span class="cp">#define SCSI_KCQDF_RROCALIBRATION                0x024090  </span><span class="cm">/* Diagnostic Failure - RRO Calibration */</span><span class="cp"></span>
<a name="line-263"></a><span class="cp">#define SCSI_KCQDF_CHANNELCALIBRATION            0x024091  </span><span class="cm">/* Diagnostic Failure - Channel Calibration */</span><span class="cp"></span>
<a name="line-264"></a><span class="cp">#define SCSI_KCQDF_HEADLOAD                      0x024092  </span><span class="cm">/* Diagnostic Failure - Head Load */</span><span class="cp"></span>
<a name="line-265"></a><span class="cp">#define SCSI_KCQDF_WRITEAE                       0x024093  </span><span class="cm">/* Diagnostic Failure - Write AE */</span><span class="cp"></span>
<a name="line-266"></a><span class="cp">#define SCSI_KCQDF_12VOVERCURRENT                0x024094  </span><span class="cm">/* Diagnostic Failure - 12V over current */</span><span class="cp"></span>
<a name="line-267"></a><span class="cp">#define SCSI_KCQDF_OTHERSPINDLEFAILURE           0x024095  </span><span class="cm">/* Diagnostic Failure - Other spindle failure */</span><span class="cp"></span>
<a name="line-268"></a><span class="cp">#define SCSI_KCQDF_SELFRESET                     0x0240b0  </span><span class="cm">/* Diagnostic Failure - self-reset */</span><span class="cp"></span>
<a name="line-269"></a><span class="cp">#define SCSI_KCQDF_CONFIGNOTLOADED               0x024c00  </span><span class="cm">/* Diagnostic Failure - config not loaded */</span><span class="cp"></span>
<a name="line-270"></a>
<a name="line-271"></a><span class="cm">/* Medium error KCQ values */</span>
<a name="line-272"></a>
<a name="line-273"></a><span class="cp">#define SCSI_KCQME_WRITEFAULT                    0x030300  </span><span class="cm">/* Medium Error - write fault */</span><span class="cp"></span>
<a name="line-274"></a><span class="cp">#define SCSI_KCQME_WRITEFAULTAUTOREALLOCFAILED   0x030c02  </span><span class="cm">/* Medium Error - write error - auto-realloc failed */</span><span class="cp"></span>
<a name="line-275"></a><span class="cp">#define SCSI_KCQME_WRITERTLIMITEXCEEDED          0x030cbb  </span><span class="cm">/* Medium Error - write recovery time limit exceeded */</span><span class="cp"></span>
<a name="line-276"></a><span class="cp">#define SCSI_KCQME_IDCRCERROR                    0x031000  </span><span class="cm">/* Medium Error - ID CRC error */</span><span class="cp"></span>
<a name="line-277"></a><span class="cp">#define SCSI_KCQME_UNRRE1                        0x031100  </span><span class="cm">/* Medium Error - unrecovered read error */</span><span class="cp"></span>
<a name="line-278"></a><span class="cp">#define SCSI_KCQME_READRETRIESEXHAUSTED          0x031101  </span><span class="cm">/* Medium Error - read retries exhausted */</span><span class="cp"></span>
<a name="line-279"></a><span class="cp">#define SCSI_KCQME_ERRORTOOLONGTOCORRECT         0x031102  </span><span class="cm">/* Medium Error - error too long to correct */</span><span class="cp"></span>
<a name="line-280"></a><span class="cp">#define SCSI_KCQME_UREAUTOREALLOCFAILED          0x031104  </span><span class="cm">/* Medium Error - unrecovered read error - auto re-alloc failed */</span><span class="cp"></span>
<a name="line-281"></a><span class="cp">#define SCSI_KCQME_URERECOMMENDREASSIGN          0x03110b  </span><span class="cm">/* Medium Error - unrecovered read error - recommend reassign */</span><span class="cp"></span>
<a name="line-282"></a><span class="cp">#define SCSI_KCQME_READRTLIMITEXCEEDED           0x0311ff  </span><span class="cm">/* Medium Error - read recovery time limit exceeded */</span><span class="cp"></span>
<a name="line-283"></a><span class="cp">#define SCSI_KCQME_RECORDNOTFOUND                0x031401  </span><span class="cm">/* Medium Error - record not found */</span><span class="cp"></span>
<a name="line-284"></a><span class="cp">#define SCSI_KCQME_DSME                          0x031600  </span><span class="cm">/* Medium Error - Data Sync Mark error */</span><span class="cp"></span>
<a name="line-285"></a><span class="cp">#define SCSI_KCQME_DSERECOMMENDREASSIGN          0x031604  </span><span class="cm">/* Medium Error - Data Sync Error - recommend reassign */</span><span class="cp"></span>
<a name="line-286"></a><span class="cp">#define SCSI_KCQME_DLE                           0x031900  </span><span class="cm">/* Medium Error - defect list error */</span><span class="cp"></span>
<a name="line-287"></a><span class="cp">#define SCSI_KCQME_DLNOTAVAILABLE                0x031901  </span><span class="cm">/* Medium Error - defect list not available */</span><span class="cp"></span>
<a name="line-288"></a><span class="cp">#define SCSI_KCQME_DLEINPRIMARYLIST              0x031902  </span><span class="cm">/* Medium Error - defect list error in primary list */</span><span class="cp"></span>
<a name="line-289"></a><span class="cp">#define SCSI_KCQME_DLEINGROWNLIST                0x031903  </span><span class="cm">/* Medium Error - defect list error in grown list */</span><span class="cp"></span>
<a name="line-290"></a><span class="cp">#define SCSI_KCQME_FEWERTHAN50PCTDLCOPIES        0x03190e  </span><span class="cm">/* Medium Error - fewer than 50% defect list copies */</span><span class="cp"></span>
<a name="line-291"></a><span class="cp">#define SCSI_KCQME_MEDIUMFORMATCORRUPTED         0x033100  </span><span class="cm">/* Medium Error - medium format corrupted */</span><span class="cp"></span>
<a name="line-292"></a><span class="cp">#define SCSI_KCQME_FORMATCOMMANDFAILED           0x033101  </span><span class="cm">/* Medium Error - format command failed */</span><span class="cp"></span>
<a name="line-293"></a><span class="cp">#define SCSI_KCQME_DATAAUTOREALLOCATED           0x038000  </span><span class="cm">/* Medium Error - data auto-reallocated */</span><span class="cp"></span>
<a name="line-294"></a>
<a name="line-295"></a><span class="cm">/* Hardware Error KCQ values */</span>
<a name="line-296"></a>
<a name="line-297"></a><span class="cp">#define SCSI_KCQHE_NOINDEXORSECTOR               0x040100  </span><span class="cm">/* Hardware Error - no index or sector */</span><span class="cp"></span>
<a name="line-298"></a><span class="cp">#define SCSI_KCQHE_NOSEEKCOMPLETE                0x040200  </span><span class="cm">/* Hardware Error - no seek complete */</span><span class="cp"></span>
<a name="line-299"></a><span class="cp">#define SCSI_KCQHE_WRITEFAULT                    0x040300  </span><span class="cm">/* Hardware Error - write fault */</span><span class="cp"></span>
<a name="line-300"></a><span class="cp">#define SCSI_KCQHE_COMMUNICATIONFAILURE          0x040800  </span><span class="cm">/* Hardware Error - communication failure */</span><span class="cp"></span>
<a name="line-301"></a><span class="cp">#define SCSI_KCQHE_TRACKFOLLOWINGERROR           0x040900  </span><span class="cm">/* Hardware Error - track following error */</span><span class="cp"></span>
<a name="line-302"></a><span class="cp">#define SCSI_KCQHE_UREINRESERVEDAREA             0x041100  </span><span class="cm">/* Hardware Error - unrecovered read error in reserved area */</span><span class="cp"></span>
<a name="line-303"></a><span class="cp">#define SCSI_KCQHE_DSMEINRESERVEDAREA            0x041600  </span><span class="cm">/* Hardware Error - Data Sync Mark error in reserved area */</span><span class="cp"></span>
<a name="line-304"></a><span class="cp">#define SCSI_KCQHE_DLE                           0x041900  </span><span class="cm">/* Hardware Error - defect list error */</span><span class="cp"></span>
<a name="line-305"></a><span class="cp">#define SCSI_KCQHE_DLEINPRIMARYLIST              0x041902  </span><span class="cm">/* Hardware Error - defect list error in Primary List */</span><span class="cp"></span>
<a name="line-306"></a><span class="cp">#define SCSI_KCQHE_DLEINGROWNLIST                0x041903  </span><span class="cm">/* Hardware Error - defect list error in Grown List */</span><span class="cp"></span>
<a name="line-307"></a><span class="cp">#define SCSI_KCQHE_REASSIGNFAILED                0x043100  </span><span class="cm">/* Hardware Error - reassign failed */</span><span class="cp"></span>
<a name="line-308"></a><span class="cp">#define SCSI_KCQHE_NODEFECTSPAREAVAILABLE        0x043200  </span><span class="cm">/* Hardware Error - no defect spare available */</span><span class="cp"></span>
<a name="line-309"></a><span class="cp">#define SCSI_KCQHE_UNSUPPORTEDENCLOSUREFUNCTION  0x043501  </span><span class="cm">/* Hardware Error - unsupported enclosure function */</span><span class="cp"></span>
<a name="line-310"></a><span class="cp">#define SCSI_KCQHE_ESUNAVAILABLE                 0x043502  </span><span class="cm">/* Hardware Error - enclosure services unavailable */</span><span class="cp"></span>
<a name="line-311"></a><span class="cp">#define SCSI_KCQHE_ESTRANSFERFAILURE             0x043503  </span><span class="cm">/* Hardware Error - enclosure services transfer failure */</span><span class="cp"></span>
<a name="line-312"></a><span class="cp">#define SCSI_KCQHE_ESREFUSED                     0x043504  </span><span class="cm">/* Hardware Error - enclosure services refused */</span><span class="cp"></span>
<a name="line-313"></a><span class="cp">#define SCSI_KCQHE_SELFTESTFAILED                0x043e03  </span><span class="cm">/* Hardware Error - self-test failed */</span><span class="cp"></span>
<a name="line-314"></a><span class="cp">#define SCSI_KCQHE_UNABLETOUPDATESELFTEST        0x043e04  </span><span class="cm">/* Hardware Error - unable to update self-test */</span><span class="cp"></span>
<a name="line-315"></a><span class="cp">#define SCSI_KCQHE_DMDIAGNOSTICFAIL              0x044080  </span><span class="cm">/* Hardware Error - Degrade Mode. Diagnostic Fail */</span><span class="cp"></span>
<a name="line-316"></a><span class="cp">#define SCSI_KCQHE_DMHWERROR                     0x044081  </span><span class="cm">/* Hardware Error - Degrade Mode. H/W Error */</span><span class="cp"></span>
<a name="line-317"></a><span class="cp">#define SCSI_KCQHE_DMRAMMICROCODENOTLOADED       0x044085  </span><span class="cm">/* Hardware Error - Degrade Mode. RAM microcode not loaded */</span><span class="cp"></span>
<a name="line-318"></a><span class="cp">#define SCSI_KCQHE_SEEKTESTFAILURE               0x044090  </span><span class="cm">/* Hardware Error - seek test failure */</span><span class="cp"></span>
<a name="line-319"></a><span class="cp">#define SCSI_KCQHE_READWRITETESTFAILURE          0x0440a0  </span><span class="cm">/* Hardware Error - read/write test failure */</span><span class="cp"></span>
<a name="line-320"></a><span class="cp">#define SCSI_KCQHE_DEVICESELFRESET               0x0440b0  </span><span class="cm">/* Hardware Error - device self-reset */</span><span class="cp"></span>
<a name="line-321"></a><span class="cp">#define SCSI_KCQHE_COMPONENTMISMATCH             0x0440d0  </span><span class="cm">/* Hardware Error - component mismatch */</span><span class="cp"></span>
<a name="line-322"></a><span class="cp">#define SCSI_KCQHE_INTERNALTARGETFAILURE         0x044400  </span><span class="cm">/* Hardware Error - internal target failure */</span><span class="cp"></span>
<a name="line-323"></a><span class="cp">#define SCSI_KCQHE_INTERNALLOGICERROR            0x048100  </span><span class="cm">/* Hardware Error - internal logic error */</span><span class="cp"></span>
<a name="line-324"></a><span class="cp">#define SCSI_KCQHE_COMMANDTIMEOUT                0x048200  </span><span class="cm">/* Hardware Error - command timeout */</span><span class="cp"></span>
<a name="line-325"></a>
<a name="line-326"></a><span class="cm">/* Illegal Request KCQ values */</span>
<a name="line-327"></a>
<a name="line-328"></a><span class="cp">#define SCSI_KCQIR_PARMLISTLENGTHERROR           0x051a00  </span><span class="cm">/* Illegal Request - parm list length error */</span><span class="cp"></span>
<a name="line-329"></a><span class="cp">#define SCSI_KCQIR_INVALIDCOMMAND                0x052000  </span><span class="cm">/* Illegal Request - invalid/unsupported command code */</span><span class="cp"></span>
<a name="line-330"></a><span class="cp">#define SCSI_KCQIR_LBAOUTOFRANGE                 0x052100  </span><span class="cm">/* Illegal Request - LBA out of range */</span><span class="cp"></span>
<a name="line-331"></a><span class="cp">#define SCSI_KCQIR_INVALIDFIELDINCBA             0x052400  </span><span class="cm">/* Illegal Request - invalid field in CDB (Command Descriptor Block) */</span><span class="cp"></span>
<a name="line-332"></a><span class="cp">#define SCSI_KCQIR_INVALIDLUN                    0x052500  </span><span class="cm">/* Illegal Request - invalid LUN */</span><span class="cp"></span>
<a name="line-333"></a><span class="cp">#define SCSI_KCQIR_INVALIDFIELDSINPARMLIST       0x052600  </span><span class="cm">/* Illegal Request - invalid fields in parm list */</span><span class="cp"></span>
<a name="line-334"></a><span class="cp">#define SCSI_KCQIR_PARAMETERNOTSUPPORTED         0x052601  </span><span class="cm">/* Illegal Request - parameter not supported */</span><span class="cp"></span>
<a name="line-335"></a><span class="cp">#define SCSI_KCQIR_INVALIDPARMVALUE              0x052602  </span><span class="cm">/* Illegal Request - invalid parm value */</span><span class="cp"></span>
<a name="line-336"></a><span class="cp">#define SCSI_KCQIR_IFPTHRESHOLDPARAMETER         0x052603  </span><span class="cm">/* Illegal Request - invalid field parameter - threshold parameter */</span><span class="cp"></span>
<a name="line-337"></a><span class="cp">#define SCSI_KCQIR_INVALIDRELEASEOFPR            0x052604  </span><span class="cm">/* Illegal Request - invalid release of persistent reservation */</span><span class="cp"></span>
<a name="line-338"></a><span class="cp">#define SCSI_KCQIR_IFPTMSFIRMWARETAG             0x052697  </span><span class="cm">/* Illegal Request - invalid field parameter - TMS firmware tag */</span><span class="cp"></span>
<a name="line-339"></a><span class="cp">#define SCSI_KCQIR_IFPCHECKSUM                   0x052698  </span><span class="cm">/* Illegal Request - invalid field parameter - check sum */</span><span class="cp"></span>
<a name="line-340"></a><span class="cp">#define SCSI_KCQIR_IFPFIRMWARETAG                0x052699  </span><span class="cm">/* Illegal Request - invalid field parameter - firmware tag */</span><span class="cp"></span>
<a name="line-341"></a><span class="cp">#define SCSI_KCQIR_COMMANDSEQUENCEERROR          0x052c00  </span><span class="cm">/* Illegal Request - command sequence error */</span><span class="cp"></span>
<a name="line-342"></a><span class="cp">#define SCSI_KCQIR_UNSUPPORTEDENCLOSUREFUNCTION  0x053501  </span><span class="cm">/* Illegal Request - unsupported enclosure function */</span><span class="cp"></span>
<a name="line-343"></a><span class="cp">#define SCSI_KCQIR_SAVINGPARMSNOTSUPPORTED       0x053900  </span><span class="cm">/* Illegal Request - Saving parameters not supported */</span><span class="cp"></span>
<a name="line-344"></a><span class="cp">#define SCSI_KCQIR_INVALIDMESSAGE                0x054900  </span><span class="cm">/* Illegal Request - invalid message */</span><span class="cp"></span>
<a name="line-345"></a><span class="cp">#define SCSI_KCQIR_MEDIALOADOREJECTFAILED        0x055300  </span><span class="cm">/* Illegal Request - media load or eject failed */</span><span class="cp"></span>
<a name="line-346"></a><span class="cp">#define SCSI_KCQIR_UNLOADTAPEFAILURE             0x055301  </span><span class="cm">/* Illegal Request - unload tape failure */</span><span class="cp"></span>
<a name="line-347"></a><span class="cp">#define SCSI_KCQIR_MEDIUMREMOVALPREVENTED        0x055302  </span><span class="cm">/* Illegal Request - medium removal prevented */</span><span class="cp"></span>
<a name="line-348"></a><span class="cp">#define SCSI_KCQIR_SYSTEMRESOURCEFAILURE         0x055500  </span><span class="cm">/* Illegal Request - system resource failure */</span><span class="cp"></span>
<a name="line-349"></a><span class="cp">#define SCSI_KCQIR_SYSTEMBUFFERFULL              0x055501  </span><span class="cm">/* Illegal Request - system buffer full */</span><span class="cp"></span>
<a name="line-350"></a><span class="cp">#define SCSI_KCQIR_INSUFFICIENTRR                0x055504  </span><span class="cm">/* Illegal Request - Insufficient Registration Resources */</span><span class="cp"></span>
<a name="line-351"></a>
<a name="line-352"></a><span class="cm">/* Unit Attention KCQ values */</span>
<a name="line-353"></a>
<a name="line-354"></a><span class="cp">#define SCSI_KCQUA_NOTREADYTOTRANSITION          0x062800  </span><span class="cm">/* Unit Attention - not-ready to ready transition (format complete) */</span><span class="cp"></span>
<a name="line-355"></a><span class="cp">#define SCSI_KCQUA_DEVICERESETOCCURRED           0x062900  </span><span class="cm">/* Unit Attention - POR or device reset occurred */</span><span class="cp"></span>
<a name="line-356"></a><span class="cp">#define SCSI_KCQUA_POROCCURRED                   0x062901  </span><span class="cm">/* Unit Attention - POR occurred */</span><span class="cp"></span>
<a name="line-357"></a><span class="cp">#define SCSI_KCQUA_SCSIBUSRESETOCCURRED          0x062902  </span><span class="cm">/* Unit Attention - SCSI bus reset occurred */</span><span class="cp"></span>
<a name="line-358"></a><span class="cp">#define SCSI_KCQUA_TARGETRESETOCCURRED           0x062903  </span><span class="cm">/* Unit Attention - TARGET RESET occurred */</span><span class="cp"></span>
<a name="line-359"></a><span class="cp">#define SCSI_KCQUA_SELFINITIATEDRESETOCCURRED    0x062904  </span><span class="cm">/* Unit Attention - self-initiated-reset occurred */</span><span class="cp"></span>
<a name="line-360"></a><span class="cp">#define SCSI_KCQUA_TRANSCEIVERMODECHANGETOSE     0x062905  </span><span class="cm">/* Unit Attention - transceiver mode change to SE */</span><span class="cp"></span>
<a name="line-361"></a><span class="cp">#define SCSI_KCQUA_TRANSCEIVERMODECHANGETOLVD    0x062906  </span><span class="cm">/* Unit Attention - transceiver mode change to LVD */</span><span class="cp"></span>
<a name="line-362"></a><span class="cp">#define SCSI_KCQUA_PARAMETERSCHANGED             0x062a00  </span><span class="cm">/* Unit Attention - parameters changed */</span><span class="cp"></span>
<a name="line-363"></a><span class="cp">#define SCSI_KCQUA_MODEPARAMETERSCHANGED         0x062a01  </span><span class="cm">/* Unit Attention - mode parameters changed */</span><span class="cp"></span>
<a name="line-364"></a><span class="cp">#define SCSI_KCQUA_LOGSELECTPARMSCHANGED         0x062a02  </span><span class="cm">/* Unit Attention - log select parms changed */</span><span class="cp"></span>
<a name="line-365"></a><span class="cp">#define SCSI_KCQUA_RESERVATIONSPREEMPTED         0x062a03  </span><span class="cm">/* Unit Attention - Reservations pre-empted */</span><span class="cp"></span>
<a name="line-366"></a><span class="cp">#define SCSI_KCQUA_RESERVATIONSRELEASED          0x062a04  </span><span class="cm">/* Unit Attention - Reservations released */</span><span class="cp"></span>
<a name="line-367"></a><span class="cp">#define SCSI_KCQUA_REGISTRATIONSPREEMPTED        0x062a05  </span><span class="cm">/* Unit Attention - Registrations pre-empted */</span><span class="cp"></span>
<a name="line-368"></a><span class="cp">#define SCSI_KCQUA_COMMANDSCLEARED               0x062f00  </span><span class="cm">/* Unit Attention - commands cleared by another initiator */</span><span class="cp"></span>
<a name="line-369"></a><span class="cp">#define SCSI_KCQUA_OPERATINGCONDITIONSCHANGED    0x063f00  </span><span class="cm">/* Unit Attention - target operating conditions have changed */</span><span class="cp"></span>
<a name="line-370"></a><span class="cp">#define SCSI_KCQUA_MICROCODECHANGED              0x063f01  </span><span class="cm">/* Unit Attention - microcode changed */</span><span class="cp"></span>
<a name="line-371"></a><span class="cp">#define SCSI_KCQUA_CHANGEDOPERATINGDEFINITION    0x063f02  </span><span class="cm">/* Unit Attention - changed operating definition */</span><span class="cp"></span>
<a name="line-372"></a><span class="cp">#define SCSI_KCQUA_INQUIRYPARAMETERSCHANGED      0x063f03  </span><span class="cm">/* Unit Attention - inquiry parameters changed */</span><span class="cp"></span>
<a name="line-373"></a><span class="cp">#define SCSI_KCQUA_DEVICEIDENTIFIERCHANGED       0x063f05  </span><span class="cm">/* Unit Attention - device identifier changed */</span><span class="cp"></span>
<a name="line-374"></a><span class="cp">#define SCSI_KCQUA_INVALIDAPMPARAMETERS          0x063f90  </span><span class="cm">/* Unit Attention - invalid APM parameters */</span><span class="cp"></span>
<a name="line-375"></a><span class="cp">#define SCSI_KCQUA_WORLDWIDENAMEMISMATCH         0x063f91  </span><span class="cm">/* Unit Attention - world-wide name mismatch */</span><span class="cp"></span>
<a name="line-376"></a><span class="cp">#define SCSI_KCQUA_PFATHRESHOLDREACHED           0x065d00  </span><span class="cm">/* Unit Attention - PFA threshold reached */</span><span class="cp"></span>
<a name="line-377"></a><span class="cp">#define SCSI_KCQUA_PFATHRESHOLDEXCEEDED          0x065dff  </span><span class="cm">/* Unit Attention - PFA threshold exceeded */</span><span class="cp"></span>
<a name="line-378"></a>
<a name="line-379"></a><span class="cm">/* Write Protect KCQ values */</span>
<a name="line-380"></a>
<a name="line-381"></a><span class="cp">#define SCSI_KCQWP_COMMANDNOTALLOWED             0x072700 </span><span class="cm">/* Write Protect - command not allowed */</span><span class="cp"></span>
<a name="line-382"></a>
<a name="line-383"></a><span class="cm">/* Aborted Command KCQ values */</span>
<a name="line-384"></a>
<a name="line-385"></a><span class="cp">#define SCSI_KCQAC_NOADDITIONALSENSECODE         0x0b0000  </span><span class="cm">/* Aborted Command - no additional sense code */</span><span class="cp"></span>
<a name="line-386"></a><span class="cp">#define SCSI_KCQAC_SYNCDATATRANSFERERROR         0x0b1b00  </span><span class="cm">/* Aborted Command - sync data transfer error (extra ACK) */</span><span class="cp"></span>
<a name="line-387"></a><span class="cp">#define SCSI_KCQAC_UNSUPPORTEDLUN                0x0b2500  </span><span class="cm">/* Aborted Command - unsupported LUN */</span><span class="cp"></span>
<a name="line-388"></a><span class="cp">#define SCSI_KCQAC_ECHOBUFFEROVERWRITTEN         0x0b3f0f  </span><span class="cm">/* Aborted Command - echo buffer overwritten */</span><span class="cp"></span>
<a name="line-389"></a><span class="cp">#define SCSI_KCQAC_MESSAGEREJECTERROR            0x0b4300  </span><span class="cm">/* Aborted Command - message reject error */</span><span class="cp"></span>
<a name="line-390"></a><span class="cp">#define SCSI_KCQAC_INTERNALTARGETFAILURE         0x0b4400  </span><span class="cm">/* Aborted Command - internal target failure */</span><span class="cp"></span>
<a name="line-391"></a><span class="cp">#define SCSI_KCQAC_SELECTIONFAILURE              0x0b4500  </span><span class="cm">/* Aborted Command - Selection/Reselection failure */</span><span class="cp"></span>
<a name="line-392"></a><span class="cp">#define SCSI_KCQAC_SCSIPARITYERROR               0x0b4700  </span><span class="cm">/* Aborted Command - SCSI parity error */</span><span class="cp"></span>
<a name="line-393"></a><span class="cp">#define SCSI_KCQAC_INITIATORDETECTEDERRORECEIVED 0x0b4800  </span><span class="cm">/* Aborted Command - initiator-detected error message received */</span><span class="cp"></span>
<a name="line-394"></a><span class="cp">#define SCSI_KCQAC_ILLEGALMESSAGE                0x0b4900  </span><span class="cm">/* Aborted Command - inappropriate/illegal message */</span><span class="cp"></span>
<a name="line-395"></a><span class="cp">#define SCSI_KCQAC_DATAPHASEERROR                0x0b4b00  </span><span class="cm">/* Aborted Command - data phase error */</span><span class="cp"></span>
<a name="line-396"></a><span class="cp">#define SCSI_KCQAC_OVERLAPPEDCOMMANDSATTEMPTED   0x0b4e00  </span><span class="cm">/* Aborted Command - overlapped commands attempted */</span><span class="cp"></span>
<a name="line-397"></a><span class="cp">#define SCSI_KCQAC_LOOPINITIALIZATION            0x0b4f00  </span><span class="cm">/* Aborted Command - due to loop initialization */</span><span class="cp"></span>
<a name="line-398"></a>
<a name="line-399"></a><span class="cm">/* Other KCQ values: */</span>
<a name="line-400"></a>
<a name="line-401"></a><span class="cp">#define SCSO_KCQOTHER_MISCOMPARE                 0x0e1d00  </span><span class="cm">/* Miscompare - during verify byte check operation */</span><span class="cp"></span>
<a name="line-402"></a>
<a name="line-403"></a><span class="cm">/* SSCSI Status Codes *******************************************************/</span>
<a name="line-404"></a>
<a name="line-405"></a><span class="cp">#define SCSI_STATUS_OK                           0x00  </span><span class="cm">/* OK */</span><span class="cp"></span>
<a name="line-406"></a><span class="cp">#define SCSI_STATUS_CHECKCONDITION               0x02  </span><span class="cm">/* Check condition */</span><span class="cp"></span>
<a name="line-407"></a><span class="cp">#define SCSI_STATUS_CONDITIONMET                 0x04  </span><span class="cm">/* Condition met */</span><span class="cp"></span>
<a name="line-408"></a><span class="cp">#define SCSI_STATUS_BUSY                         0x08  </span><span class="cm">/* Busy */</span><span class="cp"></span>
<a name="line-409"></a><span class="cp">#define SCSI_STATUS_INTERMEDIATE                 0x10  </span><span class="cm">/* Intermediate */</span><span class="cp"></span>
<a name="line-410"></a><span class="cp">#define SCSI_STATUS_DATAOVERUNDERRUN             0x12  </span><span class="cm">/* Data Under/Over Run? */</span><span class="cp"></span>
<a name="line-411"></a><span class="cp">#define SCSI_STATUS_INTERMEDIATECONDITIONMET     0x14  </span><span class="cm">/* Intermediate - Condition met */</span><span class="cp"></span>
<a name="line-412"></a><span class="cp">#define SCSI_STATUS_RESERVATIONCONFLICT          0x18  </span><span class="cm">/* Reservation conflict */</span><span class="cp"></span>
<a name="line-413"></a><span class="cp">#define SCSI_STATUS_COMMANDTERMINATED            0x22  </span><span class="cm">/* Command terminated */</span><span class="cp"></span>
<a name="line-414"></a><span class="cp">#define SCSI_STATUS_QUEUEFULL                    0x28  </span><span class="cm">/* Queue (task set) full */</span><span class="cp"></span>
<a name="line-415"></a><span class="cp">#define SCSI_STATUS_ACAACTIVE                    0x30  </span><span class="cm">/* ACA active */</span><span class="cp"></span>
<a name="line-416"></a><span class="cp">#define SCSI_STATUS_TASKABORTED                  0x40  </span><span class="cm">/* Task aborted */</span><span class="cp"></span>
<a name="line-417"></a>
<a name="line-418"></a><span class="cm">/* Definitions for selected SCSI commands ***********************************/</span>
<a name="line-419"></a>
<a name="line-420"></a><span class="cm">/* Inquiry */</span>
<a name="line-421"></a>
<a name="line-422"></a><span class="cp">#define SCSICMD_INQUIRYFLAGS_EVPD                0x01  </span><span class="cm">/* Bit 0: EVPD */</span><span class="cp"></span>
<a name="line-423"></a>                                                       <span class="cm">/* Bits 5-7: Peripheral Qualifier */</span>
<a name="line-424"></a><span class="cp">#define SCSIRESP_INQUIRYPQ_CONNECTED             0x00  </span><span class="cm">/*   000: Device is connected */</span><span class="cp"></span>
<a name="line-425"></a><span class="cp">#define SCSIRESP_INQUIRYPQ_NOTCONNECTED          0x20  </span><span class="cm">/*   001: Device is NOT connected */</span><span class="cp"></span>
<a name="line-426"></a><span class="cp">#define SCSIRESP_INQUIRYPQ_NOTCAPABLE            0x60  </span><span class="cm">/*   011: LUN not supported */</span><span class="cp"></span>
<a name="line-427"></a>                                                       <span class="cm">/* Bits 0-4: Peripheral Device */</span>
<a name="line-428"></a><span class="cp">#define SCSIRESP_INQUIRYPD_DIRECTACCESS          0x00  </span><span class="cm">/*   Direct-access block device */</span><span class="cp"></span>
<a name="line-429"></a><span class="cp">#define SCSIRESP_INQUIRYPD_SEQUENTIALACCESS      0x01  </span><span class="cm">/*   Sequential-access block device */</span><span class="cp"></span>
<a name="line-430"></a><span class="cp">#define SCSIRESP_INQUIRYPD_PRINTER               0x02  </span><span class="cm">/*   Printer device */</span><span class="cp"></span>
<a name="line-431"></a><span class="cp">#define SCSIRESP_INQUIRYPD_PROCESSOR             0x03  </span><span class="cm">/*   Processor device */</span><span class="cp"></span>
<a name="line-432"></a><span class="cp">#define SCSIRESP_INQUIRYPD_WRONCE                0x04  </span><span class="cm">/*   Write once device */</span><span class="cp"></span>
<a name="line-433"></a><span class="cp">#define SCSIRESP_INQUIRYPD_CDDVD                 0x05  </span><span class="cm">/*   CD/DVD device */</span><span class="cp"></span>
<a name="line-434"></a><span class="cp">#define SCSIRESP_INQUIRYPD_SCANNER               0x06  </span><span class="cm">/*   Scanner device (obsolete) */</span><span class="cp"></span>
<a name="line-435"></a><span class="cp">#define SCSIRESP_INQUIRYPD_OPTICAL               0x07  </span><span class="cm">/*   Optical memory device */</span><span class="cp"></span>
<a name="line-436"></a><span class="cp">#define SCSIRESP_INQUIRYPD_MEDIUMCHANGER         0x08  </span><span class="cm">/*   Medium changer device (Jukebox) */</span><span class="cp"></span>
<a name="line-437"></a><span class="cp">#define SCSIRESP_INQUIRYPD_COMMUNICATIONS        0x09  </span><span class="cm">/*   Communications device (obsolete) */</span><span class="cp"></span>
<a name="line-438"></a><span class="cp">#define SCSIRESP_INQUIRYPD_STORAGEARRAY          0x0c  </span><span class="cm">/*   Storage array controller device */</span><span class="cp"></span>
<a name="line-439"></a><span class="cp">#define SCSIRESP_INQUIRYPD_ENCLOSURESERVICES     0x0d  </span><span class="cm">/*   Enclosure services device */</span><span class="cp"></span>
<a name="line-440"></a><span class="cp">#define SCSIRESP_INQUIRYPD_RBC                   0x0e  </span><span class="cm">/*   Simplified direct-access device */</span><span class="cp"></span>
<a name="line-441"></a><span class="cp">#define SCSIRESP_INQUIRYPD_OCRW                  0x0f  </span><span class="cm">/*   Optical reader/writer device */</span><span class="cp"></span>
<a name="line-442"></a><span class="cp">#define SCSIRESP_INQUIRYPD_BCC                   0x10  </span><span class="cm">/*   Bridge controller commands */</span><span class="cp"></span>
<a name="line-443"></a><span class="cp">#define SCSIRESP_INQUIRYPD_OSD                   0x11  </span><span class="cm">/*   Object-based storage device */</span><span class="cp"></span>
<a name="line-444"></a><span class="cp">#define SCSIRESP_INQUIRYPD_ADC                   0x12  </span><span class="cm">/*   Automation/drive interface */</span><span class="cp"></span>
<a name="line-445"></a><span class="cp">#define SCSIRESP_INQUIRYPD_WKLU                  0x1e  </span><span class="cm">/*   Well-known logical unit */</span><span class="cp"></span>
<a name="line-446"></a><span class="cp">#define SCSIRESP_INQUIRYPD_UNKNOWN               0x1f  </span><span class="cm">/*   Direct-access block device */</span><span class="cp"></span>
<a name="line-447"></a>
<a name="line-448"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS1_RMB               0x80  </span><span class="cm">/* Bit 7: RMB */</span><span class="cp"></span>
<a name="line-449"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS2_NORMACA           0x20  </span><span class="cm">/* Bit 5: NormACA */</span><span class="cp"></span>
<a name="line-450"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS2_HISUP             0x10  </span><span class="cm">/* Bit 4: HiSup */</span><span class="cp"></span>
<a name="line-451"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS2_FMTMASK           0x0f  </span><span class="cm">/* Bits 0-3: Response data format */</span><span class="cp"></span>
<a name="line-452"></a>
<a name="line-453"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS3_SCCS              0x80  </span><span class="cm">/* Bit 8: SCCS */</span><span class="cp"></span>
<a name="line-454"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS3_ACC               0x40  </span><span class="cm">/* Bit 7: ACC */</span><span class="cp"></span>
<a name="line-455"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS3_TPGSMASK          0x30  </span><span class="cm">/* Bits 4-5: TPGS */</span><span class="cp"></span>
<a name="line-456"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS3_3PC               0x08  </span><span class="cm">/* Bit 3: 3PC */</span><span class="cp"></span>
<a name="line-457"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS3_PROTECT           0x01  </span><span class="cm">/* Bit 0: Protect */</span><span class="cp"></span>
<a name="line-458"></a>
<a name="line-459"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS4_BQUE              0x80  </span><span class="cm">/* Bit 7: BQue */</span><span class="cp"></span>
<a name="line-460"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS4_ENCSERV           0x40  </span><span class="cm">/* Bit 6: EncServ */</span><span class="cp"></span>
<a name="line-461"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS4_VS                0x20  </span><span class="cm">/* Bit 5: VS */</span><span class="cp"></span>
<a name="line-462"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS4_MULTIP            0x10  </span><span class="cm">/* Bit 4: MultIP */</span><span class="cp"></span>
<a name="line-463"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS4_MCHNGR            0x08  </span><span class="cm">/* Bit 3: MChngr */</span><span class="cp"></span>
<a name="line-464"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS4_ADDR16            0x01  </span><span class="cm">/* Bit 0: Addr16 */</span><span class="cp"></span>
<a name="line-465"></a>
<a name="line-466"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS5_WBUS16            0x20  </span><span class="cm">/* Bit 5: WBus16 */</span><span class="cp"></span>
<a name="line-467"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS5_SYNC              0x10  </span><span class="cm">/* Bit 4: SYNC */</span><span class="cp"></span>
<a name="line-468"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS5_LINKED            0x08  </span><span class="cm">/* Bit 3: LINKED */</span><span class="cp"></span>
<a name="line-469"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS5_CMDQUEUE          0x02  </span><span class="cm">/* Bit 1: CmdQue */</span><span class="cp"></span>
<a name="line-470"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS5_VS                0x01  </span><span class="cm">/* Bit 0: VS */</span><span class="cp"></span>
<a name="line-471"></a>
<a name="line-472"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS6_CLOCKINGMASK      0xc0  </span><span class="cm">/* Bits 2-3: Clocking */</span><span class="cp"></span>
<a name="line-473"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS6_QAS               0x02  </span><span class="cm">/* Bit 1: QAS */</span><span class="cp"></span>
<a name="line-474"></a><span class="cp">#define SCSIRESP_INQUIRYFLAGS6_IUS               0x01  </span><span class="cm">/* Bit 0: IUS */</span><span class="cp"></span>
<a name="line-475"></a>
<a name="line-476"></a><span class="cm">/* Sense data */</span>
<a name="line-477"></a><span class="cm">/* Sense data response codes */</span>
<a name="line-478"></a>
<a name="line-479"></a><span class="cp">#define SCSIRESP_SENSEDATA_CURRENTFIXED          0x70 </span><span class="cm">/* Byte 1 is always the response code */</span><span class="cp"></span>
<a name="line-480"></a><span class="cp">#define SCSIRESP_SENSEDATA_DEFERREDFIXED         0x71</span>
<a name="line-481"></a><span class="cp">#define SCSIRESP_SENSEDATA_CURRENTDESC           0x72</span>
<a name="line-482"></a><span class="cp">#define SCSIRESP_SENSEDATA_DEFERREDDESC          0x73</span>
<a name="line-483"></a>
<a name="line-484"></a><span class="cp">#define SCSIRESP_SENSEDATA_RESPVALID             0x80</span>
<a name="line-485"></a>
<a name="line-486"></a><span class="cm">/* Fixed sense data flags */</span>
<a name="line-487"></a>
<a name="line-488"></a><span class="cp">#define SCSIRESP_SENSEDATA_FILEMARK              0x80 </span><span class="cm">/* Bit 7: FileMark */</span><span class="cp"></span>
<a name="line-489"></a><span class="cp">#define SCSIRESP_SENSEDATA_EOM                   0x40 </span><span class="cm">/* Bit 6: EOM */</span><span class="cp"></span>
<a name="line-490"></a><span class="cp">#define SCSIRESP_SENSEDATA_ILI                   0x20 </span><span class="cm">/* Bit 5: ILI */</span><span class="cp"></span>
<a name="line-491"></a><span class="cp">#define SCSIRESP_SENSEDATA_SENSEKEYMASK          0x0f </span><span class="cm">/* Bits 0-3: Sense key */</span><span class="cp"></span>
<a name="line-492"></a><span class="cp">#define SCSIRESP_SENSEDATA_NOSENSE               0x00 </span><span class="cm">/*   Nothing to be reported */</span><span class="cp"></span>
<a name="line-493"></a><span class="cp">#define SCSIRESP_SENSEDATA_RECOVEREDERROR        0x01 </span><span class="cm">/*   Successful after recovery action */</span><span class="cp"></span>
<a name="line-494"></a><span class="cp">#define SCSIRESP_SENSEDATA_NOTREADY              0x02 </span><span class="cm">/*   Logical unit is not accessible */</span><span class="cp"></span>
<a name="line-495"></a><span class="cp">#define SCSIRESP_SENSEDATA_MEDIUMERROR           0x03 </span><span class="cm">/*   Error posssibly caused by flaw in medium */</span><span class="cp"></span>
<a name="line-496"></a><span class="cp">#define SCSIRESP_SENSEDATA_HARDWAREERROR         0x04 </span><span class="cm">/*   Non-recoverable hardware error */</span><span class="cp"></span>
<a name="line-497"></a><span class="cp">#define SCSIRESP_SENSEDATA_ILLEGALREQUEST        0x05 </span><span class="cm">/*   Error in recived request */</span><span class="cp"></span>
<a name="line-498"></a><span class="cp">#define SCSIRESP_SENSEDATA_UNITATTENTION         0x06 </span><span class="cm">/*   Unit attention condition */</span><span class="cp"></span>
<a name="line-499"></a><span class="cp">#define SCSIRESP_SENSEDATA_DATAPROTECT           0x07 </span><span class="cm">/*   Action failed, medium protected */</span><span class="cp"></span>
<a name="line-500"></a><span class="cp">#define SCSIRESP_SENSEDATA_BLANKCHECK            0x08 </span><span class="cm">/*   Encountered blank media */</span><span class="cp"></span>
<a name="line-501"></a><span class="cp">#define SCSIRESP_SENSEDATA_VENDORSPECIFIC        0x09 </span><span class="cm">/*   Vendor specific condition */</span><span class="cp"></span>
<a name="line-502"></a><span class="cp">#define SCSIRESP_SENSEDATA_ABORTEDCOMMAND        0x0b </span><span class="cm">/*   Command was aborted */</span><span class="cp"></span>
<a name="line-503"></a>
<a name="line-504"></a><span class="cp">#define SCSIRESP_SENSEDATA_KEYVALID              0x80 </span><span class="cm">/* Sense-specific data valid */</span><span class="cp"></span>
<a name="line-505"></a>
<a name="line-506"></a><span class="cm">/* Mode Select 6 */</span>
<a name="line-507"></a>
<a name="line-508"></a><span class="cp">#define SCSICMD_MODESELECT6_PF                   0x10 </span><span class="cm">/* Bit 4: PF */</span><span class="cp"></span>
<a name="line-509"></a><span class="cp">#define SCSICMD_MODESELECT6_SP                   0x01 </span><span class="cm">/* Bit 0: SP */</span><span class="cp"></span>
<a name="line-510"></a>
<a name="line-511"></a><span class="cm">/* Mode Sense 6 */</span>
<a name="line-512"></a>
<a name="line-513"></a><span class="cp">#define SCSICMD_MODESENSE6_DBD                   0x08 </span><span class="cm">/* Bit 3: PF */</span><span class="cp"></span>
<a name="line-514"></a>
<a name="line-515"></a><span class="cp">#define SCSICMD_MODESENSE_PCMASK                 0xc0 </span><span class="cm">/* Bits 6-7: Page control (PC) */</span><span class="cp"></span>
<a name="line-516"></a><span class="cp">#define SCSICMD_MODESENSE_PCCURRENT              0x00 </span><span class="cm">/*   Current values */</span><span class="cp"></span>
<a name="line-517"></a><span class="cp">#define SCSICMD_MODESENSE_PCCHANGEABLE           0x40 </span><span class="cm">/*   Changeable values */</span><span class="cp"></span>
<a name="line-518"></a><span class="cp">#define SCSICMD_MODESENSE_PCDEFAULT              0x80 </span><span class="cm">/*   Default values */</span><span class="cp"></span>
<a name="line-519"></a><span class="cp">#define SCSICMD_MODESENSE_PCSAVED                0xc0 </span><span class="cm">/*   Saved values */</span><span class="cp"></span>
<a name="line-520"></a><span class="cp">#define SCSICMD_MODESENSE_PGCODEMASK             0x3f </span><span class="cm">/* Bits 0-5: Page code */</span><span class="cp"></span>
<a name="line-521"></a>
<a name="line-522"></a><span class="cp">#define SCSICMD_MODESENSE6_PCDEFAULT             0x80 </span><span class="cm">/*   Default values */</span><span class="cp"></span>
<a name="line-523"></a>                                                      <span class="cm">/* Direct-access device page codes */</span>
<a name="line-524"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_VENDOR        0x00 </span><span class="cm">/*   Vendor-specific */</span><span class="cp"></span>
<a name="line-525"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_RWERROR       0x01 </span><span class="cm">/*   Read/Write error recovery mode page */</span><span class="cp"></span>
<a name="line-526"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_RECONNECT     0x02 </span><span class="cm">/*   Disconnect-reconnect mode page */</span><span class="cp"></span>
<a name="line-527"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_FORMATDEV     0x03 </span><span class="cm">/*   Format device mode page (obsolete) */</span><span class="cp"></span>
<a name="line-528"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_RIGID         0x04 </span><span class="cm">/*   Rigid disk geometry mode page (obsolete) */</span><span class="cp"></span>
<a name="line-529"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_FLEXIBLE      0x05 </span><span class="cm">/*   Flexible disk geometry mode page (obsolete) */</span><span class="cp"></span>
<a name="line-530"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_VERIFY        0x07 </span><span class="cm">/*   Verify error recovery mode page */</span><span class="cp"></span>
<a name="line-531"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_CACHING       0x08 </span><span class="cm">/*   Caching mode page */</span><span class="cp"></span>
<a name="line-532"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_CONTROL       0x0a </span><span class="cm">/*   Control mode page (0x0a/0x00) */</span><span class="cp"></span>
<a name="line-533"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_CONTROLEXT    0x0a </span><span class="cm">/*   Control extension mode page (0x0a/0x01) */</span><span class="cp"></span>
<a name="line-534"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_MEDIUMTYPES   0x0b </span><span class="cm">/*   Medum types supported mode page (obsolete) */</span><span class="cp"></span>
<a name="line-535"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_NP            0x0c </span><span class="cm">/*   Notch and partition mode page (obsolete) */</span><span class="cp"></span>
<a name="line-536"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_XOR           0x10 </span><span class="cm">/*   XOR control mode page */</span><span class="cp"></span>
<a name="line-537"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_ES            0x14 </span><span class="cm">/*   Enclosure services mode page */</span><span class="cp"></span>
<a name="line-538"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_PSLUN         0x18 </span><span class="cm">/*   Protocol-specific LUN mode page */</span><span class="cp"></span>
<a name="line-539"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_PSPORT        0x19 </span><span class="cm">/*   Protocol-specific port mode page */</span><span class="cp"></span>
<a name="line-540"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_POWER         0x1a </span><span class="cm">/*   Power condition mode page */</span><span class="cp"></span>
<a name="line-541"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_IE            0x1c </span><span class="cm">/*   Informational exceptions control mode page (0x1c/0x00) */</span><span class="cp"></span>
<a name="line-542"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_BC            0x1c </span><span class="cm">/*   Background control mode page (0x1c/0x01) */</span><span class="cp"></span>
<a name="line-543"></a><span class="cp">#define SCSIRESP_MODESENSE_PGCCODE_RETURNALL     0x3f </span><span class="cm">/*   Return all mode pages */</span><span class="cp"></span>
<a name="line-544"></a>                                                      <span class="cm">/* Direct-access caching mode page */</span>
<a name="line-545"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_PS                0x80 </span><span class="cm">/*   Byte 0, Bit 7: PS */</span><span class="cp"></span>
<a name="line-546"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_SPF               0x60 </span><span class="cm">/*   Byte 0, Bit 6: SPF */</span><span class="cp"></span>
<a name="line-547"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_IC                0x80 </span><span class="cm">/*   Byte 2, Bit 7: IC */</span><span class="cp"></span>
<a name="line-548"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_ABPF              0x40 </span><span class="cm">/*   Byte 2, Bit 6: ABPF */</span><span class="cp"></span>
<a name="line-549"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_CAP               0x20 </span><span class="cm">/*   Byte 2, Bit 5: CAP */</span><span class="cp"></span>
<a name="line-550"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_DISC              0x10 </span><span class="cm">/*   Byte 2, Bit 4: DISC */</span><span class="cp"></span>
<a name="line-551"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_SIZE              0x08 </span><span class="cm">/*   Byte 2, Bit 3: SIZE */</span><span class="cp"></span>
<a name="line-552"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_WCE               0x04 </span><span class="cm">/*   Byte 2, Bit 2: Write cache enable (WCE) */</span><span class="cp"></span>
<a name="line-553"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_MF                0x02 </span><span class="cm">/*   Byte 2, Bit 1: MF */</span><span class="cp"></span>
<a name="line-554"></a><span class="cp">#define SCSIRESP_CACHINGMODEPG_RCD               0x01 </span><span class="cm">/*   Byte 2, Bit 0: Read cache disable (RCD) */</span><span class="cp"></span>
<a name="line-555"></a>
<a name="line-556"></a><span class="cp">#define SCSIRESP_MODEPARMHDR_DAPARM_WP           0x80 </span><span class="cm">/* Bit 7: WP (Direct-access block devices only) */</span><span class="cp"></span>
<a name="line-557"></a><span class="cp">#define SCSIRESP_MODEPARMHDR_DAPARM_DBPFUA       0x10 </span><span class="cm">/* Bit 4: DBOFUA (Direct-access block devices only) */</span><span class="cp"></span>
<a name="line-558"></a>
<a name="line-559"></a><span class="cp">#define SCSIRESP_PAGEFMT_PS                      0x80 </span><span class="cm">/* Bit 7: PS */</span><span class="cp"></span>
<a name="line-560"></a><span class="cp">#define SCSIRESP_PAGEFMT_SPF                     0x40 </span><span class="cm">/* Bit 6: SPF */</span><span class="cp"></span>
<a name="line-561"></a><span class="cp">#define SCSIRESP_PAGEFMT_PGCODEMASK              0x3f </span><span class="cm">/* Bits 0-5: Page code */</span><span class="cp"></span>
<a name="line-562"></a>
<a name="line-563"></a><span class="cm">/* Prevent / Allow Medium Removal */</span>
<a name="line-564"></a>
<a name="line-565"></a><span class="cp">#define SCSICMD_PREVENTMEDIUMREMOVAL_TRANSPORT   0x01 </span><span class="cm">/* Removal prohibited from data transport */</span><span class="cp"></span>
<a name="line-566"></a><span class="cp">#define SCSICMD_PREVENTMEDIUMREMOVAL_MCHANGER    0x02 </span><span class="cm">/* Removal prohibited from medium changer */</span><span class="cp"></span>
<a name="line-567"></a>
<a name="line-568"></a><span class="cm">/* Read format capacities */</span>
<a name="line-569"></a>
<a name="line-570"></a><span class="cp">#define SCIRESP_RDFMTCAPACITIES_UNFORMATED       0x01 </span><span class="cm">/* Unformatted media */</span><span class="cp"></span>
<a name="line-571"></a><span class="cp">#define SCIRESP_RDFMTCAPACITIES_FORMATED         0x02 </span><span class="cm">/* Formatted media */</span><span class="cp"></span>
<a name="line-572"></a><span class="cp">#define SCIRESP_RDFMTCAPACITIES_NOMEDIA          0x03 </span><span class="cm">/* No media */</span><span class="cp"></span>
<a name="line-573"></a>
<a name="line-574"></a><span class="cm">/* Read 6 */</span>
<a name="line-575"></a>
<a name="line-576"></a><span class="cp">#define SCSICMD_READ6_MSLBAMASK                  0x1f</span>
<a name="line-577"></a>
<a name="line-578"></a><span class="cm">/* Write 6 */</span>
<a name="line-579"></a>
<a name="line-580"></a><span class="cp">#define SCSICMD_WRITE6_MSLBAMASK                 0x1f</span>
<a name="line-581"></a>
<a name="line-582"></a><span class="cm">/* Mode Select 10 */</span>
<a name="line-583"></a>
<a name="line-584"></a><span class="cp">#define SCSICMD_MODESELECT10_PF                  0x10 </span><span class="cm">/* Bit 4: PF */</span><span class="cp"></span>
<a name="line-585"></a><span class="cp">#define SCSICMD_MODESELECT10_SP                  0x01 </span><span class="cm">/* Bit 0: SP */</span><span class="cp"></span>
<a name="line-586"></a>
<a name="line-587"></a><span class="cm">/* Mode Sense 10 */</span>
<a name="line-588"></a>
<a name="line-589"></a><span class="cp">#define SCSICMD_MODESENSE10_LLBAA                0x10 </span><span class="cm">/* Bit 4: LLBAA */</span><span class="cp"></span>
<a name="line-590"></a><span class="cp">#define SCSICMD_MODESENSE10_DBD                  0x08 </span><span class="cm">/* Bit 3: PF */</span><span class="cp"></span>
<a name="line-591"></a>
<a name="line-592"></a><span class="cm">/* Read 10 */</span>
<a name="line-593"></a>
<a name="line-594"></a><span class="cp">#define SCSICMD_READ10FLAGS_RDPROTECTMASK        0xe0</span>
<a name="line-595"></a><span class="cp">#define SCSICMD_READ10FLAGS_DPO                  0x10 </span><span class="cm">/* Disable Page Out */</span><span class="cp"></span>
<a name="line-596"></a><span class="cp">#define SCSICMD_READ10FLAGS_FUA                  0x08</span>
<a name="line-597"></a><span class="cp">#define SCSICMD_READ10FLAGS_FUANV                0x02</span>
<a name="line-598"></a>
<a name="line-599"></a><span class="cm">/* Write 10 */</span>
<a name="line-600"></a>
<a name="line-601"></a><span class="cp">#define SCSICMD_WRITE10FLAGS_WRPROTECTMASK       0xe0</span>
<a name="line-602"></a><span class="cp">#define SCSICMD_WRITE10FLAGS_DPO                 0x10 </span><span class="cm">/* Disable Page Out */</span><span class="cp"></span>
<a name="line-603"></a><span class="cp">#define SCSICMD_WRITE10FLAGS_FUA                 0x08</span>
<a name="line-604"></a><span class="cp">#define SCSICMD_WRITE10FLAGS_FUANV               0x02</span>
<a name="line-605"></a>
<a name="line-606"></a><span class="cm">/* Verify 10 */</span>
<a name="line-607"></a>
<a name="line-608"></a><span class="cp">#define SCSICMD_VERIFY10_VRPROTECTMASK           0xe0 </span><span class="cm">/* Byte 1: Bits 5-7: VRPROTECT */</span><span class="cp"></span>
<a name="line-609"></a><span class="cp">#define SCSICMD_VERIFY10_DPO                     0x10 </span><span class="cm">/* Byte 1: Bit 4: Disable Page Out (DPO) */</span><span class="cp"></span>
<a name="line-610"></a><span class="cp">#define SCSICMD_VERIFY10_BYTCHK                  0x02 </span><span class="cm">/* Byte 1: Bit 2: BytChk */</span><span class="cp"></span>
<a name="line-611"></a>
<a name="line-612"></a><span class="cm">/* Read 12 */</span>
<a name="line-613"></a>
<a name="line-614"></a><span class="cp">#define SCSICMD_READ12FLAGS_RDPROTECTMASK        0xe0</span>
<a name="line-615"></a><span class="cp">#define SCSICMD_READ12FLAGS_DPO                  0x10 </span><span class="cm">/* Disable Page Out */</span><span class="cp"></span>
<a name="line-616"></a><span class="cp">#define SCSICMD_READ12FLAGS_FUA                  0x08</span>
<a name="line-617"></a><span class="cp">#define SCSICMD_READ12FLAGS_FUANV                0x02</span>
<a name="line-618"></a>
<a name="line-619"></a><span class="cm">/* Write 12 */</span>
<a name="line-620"></a>
<a name="line-621"></a><span class="cp">#define SCSICMD_WRITE12FLAGS_WRPROTECTMASK       0xe0</span>
<a name="line-622"></a><span class="cp">#define SCSICMD_WRITE12FLAGS_DPO                 0x10 </span><span class="cm">/* Disable Page Out */</span><span class="cp"></span>
<a name="line-623"></a><span class="cp">#define SCSICMD_WRITE12FLAGS_FUA                 0x08</span>
<a name="line-624"></a><span class="cp">#define SCSICMD_WRITE12FLAGS_FUANV               0x02</span>
<a name="line-625"></a>
<a name="line-626"></a><span class="cm">/* Verify 12 */</span>
<a name="line-627"></a>
<a name="line-628"></a><span class="cp">#define SCSICMD_VERIFY12_VRPROTECTMASK           0xe0 </span><span class="cm">/* Byte 1: Bits 5-7: VRPROTECT */</span><span class="cp"></span>
<a name="line-629"></a><span class="cp">#define SCSICMD_VERIFY12_DPO                     0x10 </span><span class="cm">/* Byte 1: Bit 4: Disable Page Out (DPO) */</span><span class="cp"></span>
<a name="line-630"></a><span class="cp">#define SCSICMD_VERIFY12_BYTCHK                  0x02 </span><span class="cm">/* Byte 1: Bit 2: BytChk */</span><span class="cp"></span>
<a name="line-631"></a>
<a name="line-632"></a><span class="cm">/****************************************************************************</span>
<a name="line-633"></a><span class="cm"> * Public Types</span>
<a name="line-634"></a><span class="cm"> ****************************************************************************/</span>
<a name="line-635"></a>
<a name="line-636"></a><span class="cm">/* Format structures for selected SCSI primary commands */</span>
<a name="line-637"></a>
<a name="line-638"></a><span class="cp">#define SCSICMD_TESTUNITREADY_SIZEOF 6</span>
<a name="line-639"></a>
<a name="line-640"></a><span class="k">struct</span> <span class="n">scsicmd_requestsense_s</span>
<a name="line-641"></a><span class="p">{</span>
<a name="line-642"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x03 */</span>
<a name="line-643"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_REQUESTSENSE_FLAGS_* */</span>
<a name="line-644"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 2-3: Reserved */</span>
<a name="line-645"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">alloclen</span><span class="p">;</span>      <span class="cm">/* 4: Allocation length */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-646"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span>
<a name="line-647"></a><span class="p">};</span>
<a name="line-648"></a><span class="cp">#define SCSICMD_REQUESTSENSE_SIZEOF 6</span>
<a name="line-649"></a><span class="cp">#define SCSICMD_REQUESTSENSE_MSSIZEOF 12 </span><span class="cm">/* MS-Windows REQUEST SENSE with cbw-&gt;cdblen == 12 */</span><span class="cp"></span>
<a name="line-650"></a>
<a name="line-651"></a><span class="k">struct</span> <span class="n">scsiresp_fixedsensedata_s</span>
<a name="line-652"></a><span class="p">{</span>
<a name="line-653"></a>  <span class="kt">uint8_t</span> <span class="n">code</span><span class="p">;</span>          <span class="cm">/* 0: Response code See  SCSIRESP_SENSEDATA_*FIXED defns */</span>
<a name="line-654"></a>  <span class="kt">uint8_t</span> <span class="n">obsolete</span><span class="p">;</span>      <span class="cm">/* 1: */</span>
<a name="line-655"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 2: See SCSIRESP_SENSEDATA_* definitions */</span>
<a name="line-656"></a>  <span class="kt">uint8_t</span> <span class="n">info</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>       <span class="cm">/* 3-6: Information */</span>
<a name="line-657"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">len</span><span class="p">;</span>           <span class="cm">/* 7: Additional length */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-658"></a>  <span class="kt">uint8_t</span> <span class="n">cmdinfo</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>    <span class="cm">/* 8-11: Command-specific information */</span>
<a name="line-659"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">code2</span><span class="p">;</span>         <span class="cm">/* 12: Additional sense code */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-660"></a>  <span class="kt">uint8_t</span> <span class="n">qual2</span><span class="p">;</span>         <span class="cm">/* 13: Additional sense code qualifier */</span>
<a name="line-661"></a>  <span class="kt">uint8_t</span> <span class="n">fru</span><span class="p">;</span>           <span class="cm">/* 14: Field replacement unit code */</span>
<a name="line-662"></a>  <span class="kt">uint8_t</span> <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>        <span class="cm">/* 15-17: Sense key specific */</span>
<a name="line-663"></a>                         <span class="cm">/* 18-: Additional bytes may follow */</span>
<a name="line-664"></a><span class="p">};</span>
<a name="line-665"></a><span class="cp">#define SCSIRESP_FIXEDSENSEDATA_SIZEOF 18 </span><span class="cm">/* Minimum size */</span><span class="cp"></span>
<a name="line-666"></a>
<a name="line-667"></a><span class="k">struct</span> <span class="n">scscicmd_inquiry_s</span>
<a name="line-668"></a><span class="p">{</span>
<a name="line-669"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x12 */</span>
<a name="line-670"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_INQUIRY_FLAGS_* */</span>
<a name="line-671"></a>  <span class="kt">uint8_t</span> <span class="n">pagecode</span><span class="p">;</span>      <span class="cm">/* 2: Page code */</span>
<a name="line-672"></a>  <span class="kt">uint8_t</span> <span class="n">alloclen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 3-4: Allocation length */</span>
<a name="line-673"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-674"></a><span class="p">};</span>
<a name="line-675"></a><span class="cp">#define SCSICMD_INQUIRY_SIZEOF 6</span>
<a name="line-676"></a>
<a name="line-677"></a><span class="cp">#define SCSI_GET_INQUIRY_PDT(pdt) ((pdt) &amp; 0x1f)    </span><span class="cm">/* get the Peripheral Device Type */</span><span class="cp"></span>
<a name="line-678"></a><span class="cp">#define SCSI_GET_INQUIRY_RMB(rmb) ((rmb) &gt;&gt; 7)      </span><span class="cm">/* get  Removable Medium Bit */</span><span class="cp"></span>
<a name="line-679"></a><span class="cp">#define SCSI_MEDIUM_NOT_REMOVABLE (0)               </span><span class="cm">/* Not Removable */</span><span class="cp"></span>
<a name="line-680"></a><span class="cp">#define SCSI_MEDIUM_CAN_REMOVABLE (1)               </span><span class="cm">/* Can Removable */</span><span class="cp"></span>
<a name="line-681"></a>
<a name="line-682"></a><span class="k">struct</span> <span class="n">scsiresp_inquiry_s</span>
<a name="line-683"></a><span class="p">{</span>
<a name="line-684"></a>  <span class="cm">/* Mandatory */</span>
<a name="line-685"></a>
<a name="line-686"></a>  <span class="kt">uint8_t</span> <span class="n">qualtype</span><span class="p">;</span>      <span class="cm">/* 0: Bits 5-7: Peripheral qualifier; Bits 0-4: Peripheral device type */</span>
<a name="line-687"></a>  <span class="kt">uint8_t</span> <span class="n">flags1</span><span class="p">;</span>        <span class="cm">/* 1: See SCSIRESP_INQUIRY_FLAGS1_* */</span>
<a name="line-688"></a>  <span class="kt">uint8_t</span> <span class="n">version</span><span class="p">;</span>       <span class="cm">/* 2: Version */</span>
<a name="line-689"></a>  <span class="kt">uint8_t</span> <span class="n">flags2</span><span class="p">;</span>        <span class="cm">/* 3: See SCSIRESP_INQUIRY_FLAGS2_* */</span>
<a name="line-690"></a>  <span class="kt">uint8_t</span> <span class="n">len</span><span class="p">;</span>           <span class="cm">/* 4: Additional length */</span>
<a name="line-691"></a>  <span class="kt">uint8_t</span> <span class="n">flags3</span><span class="p">;</span>        <span class="cm">/* 5: See SCSIRESP_INQUIRY_FLAGS3_* */</span>
<a name="line-692"></a>  <span class="kt">uint8_t</span> <span class="n">flags4</span><span class="p">;</span>        <span class="cm">/* 6: See SCSIRESP_INQUIRY_FLAGS4_* */</span>
<a name="line-693"></a>  <span class="kt">uint8_t</span> <span class="n">flags5</span><span class="p">;</span>        <span class="cm">/* 7: See SCSIRESP_INQUIRY_FLAGS5_* */</span>
<a name="line-694"></a>  <span class="kt">uint8_t</span> <span class="n">vendorid</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>   <span class="cm">/* 8-15: T10 Vendor Identification */</span>
<a name="line-695"></a>  <span class="kt">uint8_t</span> <span class="n">productid</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="cm">/* 16-31: Product Identification */</span>
<a name="line-696"></a>  <span class="kt">uint8_t</span> <span class="n">revision</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>   <span class="cm">/* 32-35: Product Revision Level */</span>
<a name="line-697"></a>
<a name="line-698"></a>  <span class="cm">/* Optional */</span>
<a name="line-699"></a>
<a name="line-700"></a>  <span class="kt">uint8_t</span> <span class="n">vendor</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>    <span class="cm">/* 36-55: Vendor specific */</span>
<a name="line-701"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">flags6</span><span class="p">;</span>        <span class="cm">/* 56: See SCSIRESP_INQUIRY_FLAGS6_* */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-702"></a>  <span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">;</span>     <span class="cm">/* 57: Reserved */</span>
<a name="line-703"></a>  <span class="kt">uint8_t</span> <span class="n">version1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 58-59: Version Descriptor 1 */</span>
<a name="line-704"></a>  <span class="kt">uint8_t</span> <span class="n">version2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 60-61: Version Descriptor 2 */</span>
<a name="line-705"></a>  <span class="kt">uint8_t</span> <span class="n">version3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 62-63: Version Descriptor 3 */</span>
<a name="line-706"></a>  <span class="kt">uint8_t</span> <span class="n">version4</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 64-65: Version Descriptor 4 */</span>
<a name="line-707"></a>  <span class="kt">uint8_t</span> <span class="n">version5</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 66-67: Version Descriptor 5 */</span>
<a name="line-708"></a>  <span class="kt">uint8_t</span> <span class="n">version6</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 68-69: Version Descriptor 6 */</span>
<a name="line-709"></a>  <span class="kt">uint8_t</span> <span class="n">version7</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 70-71: Version Descriptor 7 */</span>
<a name="line-710"></a>  <span class="kt">uint8_t</span> <span class="n">version8</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 72-73: Version Descriptor 8 */</span>
<a name="line-711"></a>  <span class="kt">uint8_t</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span> <span class="cm">/* 74-95: Reserved */</span>
<a name="line-712"></a>                       <span class="cm">/* 96-: Vendor-specific parameters may follow */</span>
<a name="line-713"></a><span class="p">};</span>
<a name="line-714"></a><span class="cp">#define SCSIRESP_INQUIRY_SIZEOF 36 </span><span class="cm">/* Minimum size */</span><span class="cp"></span>
<a name="line-715"></a>
<a name="line-716"></a><span class="k">struct</span> <span class="n">scsicmd_modeselect6_s</span>
<a name="line-717"></a><span class="p">{</span>
<a name="line-718"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0x15 */</span>
<a name="line-719"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_MODESELECT6_FLAGS_* */</span>
<a name="line-720"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 2-3: Reserved */</span>
<a name="line-721"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">plen</span><span class="p">;</span>          <span class="cm">/* 4: Parameter list length */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-722"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span>
<a name="line-723"></a><span class="p">};</span>
<a name="line-724"></a><span class="cp">#define SCSICMD_MODESELECT6_SIZEOF 6</span>
<a name="line-725"></a>
<a name="line-726"></a><span class="k">struct</span> <span class="n">scsicmd_modesense6_s</span>
<a name="line-727"></a><span class="p">{</span>
<a name="line-728"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0x1a */</span>
<a name="line-729"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_MODESENSE6_FLAGS_* */</span>
<a name="line-730"></a>  <span class="kt">uint8_t</span> <span class="n">pcpgcode</span><span class="p">;</span>      <span class="cm">/* 2: Bits 6-7: PC, bits 0-5: page code */</span>
<a name="line-731"></a>  <span class="kt">uint8_t</span> <span class="n">subpgcode</span><span class="p">;</span>     <span class="cm">/* 3: subpage code */</span>
<a name="line-732"></a>  <span class="kt">uint8_t</span> <span class="n">alloclen</span><span class="p">;</span>      <span class="cm">/* 4: Allocation length */</span>
<a name="line-733"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span>
<a name="line-734"></a><span class="p">};</span>
<a name="line-735"></a><span class="cp">#define SCSICMD_MODESENSE6_SIZEOF 6</span>
<a name="line-736"></a>
<a name="line-737"></a><span class="k">struct</span> <span class="n">scsiresp_modeparameterhdr6_s</span>
<a name="line-738"></a><span class="p">{</span>
<a name="line-739"></a>  <span class="kt">uint8_t</span> <span class="n">mdlen</span><span class="p">;</span>         <span class="cm">/* 0: Mode data length */</span>
<a name="line-740"></a>  <span class="kt">uint8_t</span> <span class="n">type</span><span class="p">;</span>          <span class="cm">/* 1: Medium type */</span>
<a name="line-741"></a>  <span class="kt">uint8_t</span> <span class="n">param</span><span class="p">;</span>         <span class="cm">/* 2: Device-specific parameter */</span>
<a name="line-742"></a>  <span class="kt">uint8_t</span> <span class="n">bdlen</span><span class="p">;</span>         <span class="cm">/* 3: Block descriptor length */</span>
<a name="line-743"></a><span class="p">};</span>
<a name="line-744"></a><span class="cp">#define SCSIRESP_MODEPARAMETERHDR6_SIZEOF 4</span>
<a name="line-745"></a>
<a name="line-746"></a><span class="k">struct</span> <span class="n">scsiresp_blockdesc_s</span>
<a name="line-747"></a><span class="p">{</span>
<a name="line-748"></a>  <span class="kt">uint8_t</span> <span class="n">density</span><span class="p">;</span>       <span class="cm">/* 0: density code */</span>
<a name="line-749"></a>  <span class="kt">uint8_t</span> <span class="n">nblocks</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>    <span class="cm">/* 1-3: Number of blocks */</span>
<a name="line-750"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">;</span>      <span class="cm">/* 4: reserved */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-751"></a>  <span class="kt">uint8_t</span> <span class="n">blklen</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>     <span class="cm">/* 5-7: Block len */</span>
<a name="line-752"></a><span class="p">};</span>
<a name="line-753"></a><span class="cp">#define SCSIRESP_BLOCKDESC_SIZEOF 8</span>
<a name="line-754"></a>
<a name="line-755"></a><span class="k">struct</span> <span class="n">scsiresp_pageformat_s</span>
<a name="line-756"></a><span class="p">{</span>
<a name="line-757"></a>  <span class="kt">uint8_t</span> <span class="n">pgcode</span><span class="p">;</span>       <span class="cm">/* 0: See SCSIRESP_PAGEFMT_* definitions */</span>
<a name="line-758"></a>  <span class="kt">uint8_t</span> <span class="n">pglen</span><span class="p">;</span>        <span class="cm">/* 1: Page length (n-1) */</span>
<a name="line-759"></a>  <span class="kt">uint8_t</span> <span class="n">parms</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>     <span class="cm">/* 2-n: Mode parameters */</span>
<a name="line-760"></a><span class="p">};</span>
<a name="line-761"></a>
<a name="line-762"></a><span class="k">struct</span> <span class="n">scsiresp_subpageformat_s</span>
<a name="line-763"></a><span class="p">{</span>
<a name="line-764"></a>  <span class="kt">uint8_t</span> <span class="n">pgcode</span><span class="p">;</span>       <span class="cm">/* 0: See SCSIRESP_PAGEFMT_* definitions */</span>
<a name="line-765"></a>  <span class="kt">uint8_t</span> <span class="n">subpgcode</span><span class="p">;</span>    <span class="cm">/* 1: sub-page code */</span>
<a name="line-766"></a>  <span class="kt">uint8_t</span> <span class="n">pglen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>     <span class="cm">/* 2-3: Page length (n-3) */</span>
<a name="line-767"></a>  <span class="kt">uint8_t</span> <span class="n">parms</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>     <span class="cm">/* 4-n: Mode parameters */</span>
<a name="line-768"></a><span class="p">};</span>
<a name="line-769"></a>
<a name="line-770"></a><span class="k">struct</span> <span class="n">scsiresp_cachingmodepage_s</span>
<a name="line-771"></a><span class="p">{</span>
<a name="line-772"></a>  <span class="kt">uint8_t</span> <span class="n">pgcode</span><span class="p">;</span>      <span class="cm">/* 0: Bit 7: PS; Bit 6: SPF, Bits 0-5: page code == 8 */</span>
<a name="line-773"></a>  <span class="kt">uint8_t</span> <span class="n">len</span><span class="p">;</span>         <span class="cm">/* 1: Page length (18) */</span>
<a name="line-774"></a>  <span class="kt">uint8_t</span> <span class="n">flags1</span><span class="p">;</span>      <span class="cm">/* 2: See SCSIRESP_CACHINGMODEPG_* definitions */</span>
<a name="line-775"></a>  <span class="kt">uint8_t</span> <span class="n">priority</span><span class="p">;</span>    <span class="cm">/* 3: Bits 4-7: Demand read retention priority; Bits 0-3: Write retention priority */</span>
<a name="line-776"></a>  <span class="kt">uint8_t</span> <span class="n">dpflen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 4-5: Disable prefetch transfer length */</span>
<a name="line-777"></a>  <span class="kt">uint8_t</span> <span class="n">minpf</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>    <span class="cm">/* 6-7: Minimum pre-fetch */</span>
<a name="line-778"></a>  <span class="kt">uint8_t</span> <span class="n">maxpf</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>    <span class="cm">/* 8-9: Maximum pre-fetch */</span>
<a name="line-779"></a>  <span class="kt">uint8_t</span> <span class="n">maxpfc</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 10-11: Maximum pref-fetch ceiling */</span>
<a name="line-780"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">flags2</span><span class="p">;</span>      <span class="cm">/* 12: See SCSIRESP_CACHINGMODEPG_* definitions */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-781"></a>  <span class="kt">uint8_t</span> <span class="n">nsegments</span><span class="p">;</span>   <span class="cm">/* 13: Number of cache segments */</span>
<a name="line-782"></a>  <span class="kt">uint8_t</span> <span class="n">segsize</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>  <span class="cm">/* 14-15: Cache segment size */</span>
<a name="line-783"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">;</span>    <span class="cm">/* 16: Reserved */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-784"></a>  <span class="kt">uint8_t</span> <span class="n">obsolete</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="cm">/* 17-19: Obsolete */</span>
<a name="line-785"></a><span class="p">};</span>
<a name="line-786"></a>
<a name="line-787"></a><span class="cm">/* Format structures for selected SCSI block commands */</span>
<a name="line-788"></a>
<a name="line-789"></a><span class="k">struct</span> <span class="n">scsicmd_read6_s</span>
<a name="line-790"></a><span class="p">{</span>
<a name="line-791"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x08 */</span>
<a name="line-792"></a>  <span class="kt">uint8_t</span> <span class="n">mslba</span><span class="p">;</span>         <span class="cm">/* 1: Bits 5-7: reserved; Bits 0-6: MS Logical Block Address (LBA) */</span>
<a name="line-793"></a>  <span class="kt">uint8_t</span> <span class="n">lslba</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>      <span class="cm">/* 2-3: LS Logical Block Address (LBA) */</span>
<a name="line-794"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">;</span>        <span class="cm">/* 4: Transfer length (in contiguous logical blocks)*/</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-795"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span>
<a name="line-796"></a><span class="p">};</span>
<a name="line-797"></a><span class="cp">#define SCSICMD_READ6_SIZEOF 6</span>
<a name="line-798"></a>
<a name="line-799"></a><span class="k">struct</span> <span class="n">scsicmd_write6_s</span>
<a name="line-800"></a><span class="p">{</span>
<a name="line-801"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x0a */</span>
<a name="line-802"></a>  <span class="kt">uint8_t</span> <span class="n">mslba</span><span class="p">;</span>         <span class="cm">/* 1: Bits 5-7: reserved; Bits 0-6: MS Logical Block Address (LBA) */</span>
<a name="line-803"></a>  <span class="kt">uint8_t</span> <span class="n">lslba</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>      <span class="cm">/* 2-3: LS Logical Block Address (LBA) */</span>
<a name="line-804"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">;</span>        <span class="cm">/* 4: Transfer length (in contiguous logical blocks) */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-805"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span>
<a name="line-806"></a><span class="p">};</span>
<a name="line-807"></a><span class="cp">#define SCSICMD_WRITE6_SIZEOF 6</span>
<a name="line-808"></a>
<a name="line-809"></a><span class="k">struct</span> <span class="n">scsicmd_startstopunit_s</span>
<a name="line-810"></a><span class="p">{</span>
<a name="line-811"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x1b */</span>
<a name="line-812"></a>  <span class="kt">uint8_t</span> <span class="n">immed</span><span class="p">;</span>         <span class="cm">/* 1: Bits 2-7: Reserved, Bit 0: Immed */</span>
<a name="line-813"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">;</span>      <span class="cm">/* 2: reserved */</span>
<a name="line-814"></a>  <span class="kt">uint8_t</span> <span class="n">pcm</span><span class="p">;</span>           <span class="cm">/* 3: Bits 4-7: Reserved, Bits 0-3: Power condition modifier */</span>
<a name="line-815"></a>  <span class="kt">uint8_t</span> <span class="n">pc</span><span class="p">;</span>            <span class="cm">/* 4: Bits 4-7: Power condition, Bit 2: NO_FLUSH, Bit 1: LOEJ, Bit 0: START */</span>
<a name="line-816"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span>
<a name="line-817"></a><span class="p">};</span>
<a name="line-818"></a><span class="cp">#define SCSICMD_STARTSTOPUNIT_SIZEOF 6</span>
<a name="line-819"></a>
<a name="line-820"></a><span class="k">struct</span> <span class="n">scsicmd_preventmediumremoval_s</span>
<a name="line-821"></a><span class="p">{</span>
<a name="line-822"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x1e */</span>
<a name="line-823"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>   <span class="cm">/* 1-3: Reserved */</span>
<a name="line-824"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">prevent</span><span class="p">;</span>       <span class="cm">/* 4: Bits 2-7: Reserved, Bits 0:1: prevent */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-825"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 5: Control */</span>
<a name="line-826"></a><span class="p">};</span>
<a name="line-827"></a><span class="cp">#define SCSICMD_PREVENTMEDIUMREMOVAL_SIZEOF 6</span>
<a name="line-828"></a>
<a name="line-829"></a><span class="k">struct</span> <span class="n">scsicmd_readformatcapcacities_s</span>
<a name="line-830"></a><span class="p">{</span>
<a name="line-831"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x23 */</span>
<a name="line-832"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>   <span class="cm">/* 1-6: Reserved */</span>
<a name="line-833"></a>  <span class="kt">uint8_t</span> <span class="n">alloclen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 7-8: Allocation length */</span>
<a name="line-834"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-835"></a><span class="p">};</span>
<a name="line-836"></a><span class="cp">#define SCSICMD_READFORMATCAPACITIES_SIZEOF 10</span>
<a name="line-837"></a>
<a name="line-838"></a><span class="k">struct</span> <span class="n">scsiresp_readformatcapacities_s</span>
<a name="line-839"></a><span class="p">{</span>
<a name="line-840"></a>  <span class="cm">/* Current capacity header */</span>
<a name="line-841"></a>
<a name="line-842"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>  <span class="cm">/* 0-2: Reserved */</span>
<a name="line-843"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">listlen</span><span class="p">;</span>      <span class="cm">/* 3: Capacity list length */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-844"></a>
<a name="line-845"></a>  <span class="cm">/* Current/Maximum Capacity Descriptor (actually a separate structure) */</span>
<a name="line-846"></a>
<a name="line-847"></a>  <span class="kt">uint8_t</span> <span class="n">nblocks</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>   <span class="cm">/* 4-7: Number of blocks */</span>
<a name="line-848"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">type</span><span class="p">;</span>         <span class="cm">/* 8: Bits 2-7: Reserved, Bits 0-1: Descriptor type */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-849"></a>  <span class="kt">uint8_t</span> <span class="n">blocklen</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>  <span class="cm">/* 9-11: Block length */</span>
<a name="line-850"></a><span class="p">};</span>
<a name="line-851"></a><span class="cp">#define SCSIRESP_READFORMATCAPACITIES_SIZEOF 12</span>
<a name="line-852"></a><span class="cp">#define SCSIRESP_CURRCAPACITYDESC_SIZEOF 8</span>
<a name="line-853"></a>
<a name="line-854"></a><span class="k">struct</span> <span class="n">scsiresp_formattedcapacitydesc_s</span>
<a name="line-855"></a><span class="p">{</span>
<a name="line-856"></a>  <span class="kt">uint8_t</span> <span class="n">nblocks</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>   <span class="cm">/* 0-3: Number of blocks */</span>
<a name="line-857"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">type</span><span class="p">;</span>         <span class="cm">/* 4: Bits 2-7: Type, bits 0-1, reserved */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-858"></a>  <span class="kt">uint8_t</span> <span class="n">param</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>     <span class="cm">/* 5-7: Type dependent parameter */</span>
<a name="line-859"></a><span class="p">};</span>
<a name="line-860"></a><span class="cp">#define SCSIRESP_FORMATTEDCAPACITYDESC_SIZEOF 8</span>
<a name="line-861"></a>
<a name="line-862"></a><span class="k">struct</span> <span class="n">scsicmd_readcapacity10_s</span>
<a name="line-863"></a><span class="p">{</span>
<a name="line-864"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x25 */</span>
<a name="line-865"></a>  <span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">;</span>     <span class="cm">/* 1: Bits 1-7: Reserved, Bit 0: Obsolete */</span>
<a name="line-866"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical block address (LBA) */</span>
<a name="line-867"></a>  <span class="kt">uint8_t</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>  <span class="cm">/* 6-7: Reserved */</span>
<a name="line-868"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">pmi</span><span class="p">;</span>           <span class="cm">/* 8: Bits 1-7 Reserved; Bit 0: PMI */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-869"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span>
<a name="line-870"></a><span class="p">};</span>
<a name="line-871"></a><span class="cp">#define SCSICMD_READCAPACITY10_SIZEOF 10</span>
<a name="line-872"></a>
<a name="line-873"></a><span class="k">struct</span> <span class="n">scsiresp_readcapacity10_s</span>
<a name="line-874"></a><span class="p">{</span>
<a name="line-875"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 0-3: Returned logical block address (LBA) */</span>
<a name="line-876"></a>  <span class="kt">uint8_t</span> <span class="n">blklen</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="cm">/* 4-7: Logical block length (in bytes) */</span>
<a name="line-877"></a><span class="p">};</span>
<a name="line-878"></a><span class="cp">#define SCSIRESP_READCAPACITY10_SIZEOF 8</span>
<a name="line-879"></a>
<a name="line-880"></a><span class="k">struct</span> <span class="n">scsicmd_readcapacity16_s</span>
<a name="line-881"></a><span class="p">{</span>
<a name="line-882"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x9E */</span>
<a name="line-883"></a>  <span class="kt">uint8_t</span> <span class="n">reserved1</span><span class="p">;</span>     <span class="cm">/* 1: Bits 0-4: Service Action, Bit 5-7: Reserved */</span>
<a name="line-884"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>        <span class="cm">/* 2-9: Logical block address (LBA) */</span>
<a name="line-885"></a>  <span class="kt">uint8_t</span> <span class="n">blklen</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="cm">/* 10-13: Allocation Length */</span>
<a name="line-886"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">pmi</span><span class="p">;</span>           <span class="cm">/* 14: Bits 1-7 Reserved; Bit 0: PMI */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-887"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 15: Control */</span>
<a name="line-888"></a><span class="p">};</span>
<a name="line-889"></a><span class="cp">#define SCSICMD_READCAPACITY16_SIZEOF 16</span>
<a name="line-890"></a>
<a name="line-891"></a><span class="k">struct</span> <span class="n">scsiresp_readcapacity16_s</span>
<a name="line-892"></a><span class="p">{</span>
<a name="line-893"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>        <span class="cm">/* 0-7: Returned logical block address (LBA) */</span>
<a name="line-894"></a>  <span class="kt">uint8_t</span> <span class="n">blklen</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="cm">/* 8-11: Logical block length (in bytes) */</span>
<a name="line-895"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">prot</span><span class="p">;</span>          <span class="cm">/* 12: Bits 0: PROT_EN, Bits 1-3: P_TYPE, Bits 4-7: Reserved*/</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-896"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">19</span><span class="p">];</span>  <span class="cm">/* 13-31: Reserved */</span>
<a name="line-897"></a><span class="p">};</span>
<a name="line-898"></a><span class="cp">#define SCSIRESP_READCAPACITY16_SIZEOF 32</span>
<a name="line-899"></a>
<a name="line-900"></a><span class="k">struct</span> <span class="n">scsicmd_read16_s</span>
<a name="line-901"></a><span class="p">{</span>
<a name="line-902"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x88 */</span>
<a name="line-903"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_READ16 FLAGS* */</span>
<a name="line-904"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>        <span class="cm">/* 2-9: Logical Block Address (LBA) */</span>
<a name="line-905"></a>  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="cm">/* 10-13: Transfer length (in contiguous logical blocks) */</span>
<a name="line-906"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 14: Bits 7: Restricted for MMC-4; Bits 5-6: reserved; Bits 0-4: group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-907"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 15: Control */</span>
<a name="line-908"></a><span class="p">};</span>
<a name="line-909"></a><span class="cp">#define SCSICMD_READ16_SIZEOF 16</span>
<a name="line-910"></a>
<a name="line-911"></a><span class="k">struct</span> <span class="n">scsicmd_write16_s</span>
<a name="line-912"></a><span class="p">{</span>
<a name="line-913"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x8a */</span>
<a name="line-914"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_WRITE10FLAGS_* */</span>
<a name="line-915"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>        <span class="cm">/* 2-9: Logical Block Address (LBA) */</span>
<a name="line-916"></a>  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="cm">/* 10-13: Transfer length (in contiguous logical blocks) */</span>
<a name="line-917"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 14: Bits 7: RESTRICTED FOR MMC-4; Bits 5-6: reserved; Bits 0-4: group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-918"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span>
<a name="line-919"></a><span class="p">};</span>
<a name="line-920"></a><span class="cp">#define SCSICMD_WRITE16_SIZEOF 16</span>
<a name="line-921"></a>
<a name="line-922"></a><span class="k">struct</span> <span class="n">scsicmd_read10_s</span>
<a name="line-923"></a><span class="p">{</span>
<a name="line-924"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x28 */</span>
<a name="line-925"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_READ10FLAGS_* */</span>
<a name="line-926"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical Block Address (LBA) */</span>
<a name="line-927"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 6: Bits 5-7: reserved; Bits 0-6: group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-928"></a>  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>     <span class="cm">/* 7-8: Transfer length (in contiguous logical blocks) */</span>
<a name="line-929"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-930"></a><span class="p">};</span>
<a name="line-931"></a><span class="cp">#define SCSICMD_READ10_SIZEOF 10</span>
<a name="line-932"></a>
<a name="line-933"></a><span class="k">struct</span> <span class="n">scsicmd_write10_s</span>
<a name="line-934"></a><span class="p">{</span>
<a name="line-935"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x2a */</span>
<a name="line-936"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_WRITE10FLAGS_* */</span>
<a name="line-937"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical Block Address (LBA) */</span>
<a name="line-938"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 6: Bits 5-7: reserved; Bits 0-6: group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-939"></a>  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>     <span class="cm">/* 7-8: Transfer length (in contiguous logical blocks) */</span>
<a name="line-940"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-941"></a><span class="p">};</span>
<a name="line-942"></a><span class="cp">#define SCSICMD_WRITE10_SIZEOF 10</span>
<a name="line-943"></a>
<a name="line-944"></a><span class="k">struct</span> <span class="n">scsicmd_verify10_s</span>
<a name="line-945"></a><span class="p">{</span>
<a name="line-946"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x2f */</span>
<a name="line-947"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_VERIFY10_* definitions */</span>
<a name="line-948"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical block address (LBA) */</span>
<a name="line-949"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 6: Bit 7: restricted; Bits 5-6: Reserved, Bits 0-4: Group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-950"></a>  <span class="kt">uint8_t</span> <span class="n">len</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>        <span class="cm">/* 7-8: Verification length (in blocks) */</span>
<a name="line-951"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-952"></a><span class="p">};</span>
<a name="line-953"></a><span class="cp">#define SCSICMD_VERIFY10_SIZEOF 10</span>
<a name="line-954"></a>
<a name="line-955"></a><span class="k">struct</span> <span class="n">scsicmd_synchronizecache10_s</span>
<a name="line-956"></a><span class="p">{</span>
<a name="line-957"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x35 */</span>
<a name="line-958"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_SYNCHRONIZECACHE10_* definitions */</span>
<a name="line-959"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical block address (LBA) */</span>
<a name="line-960"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 6: Bit 7: restricted; Bits 5-6: Reserved, Bits 0-4: Group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-961"></a>  <span class="kt">uint8_t</span> <span class="n">len</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>        <span class="cm">/* 7-8: Number of logical blocks */</span>
<a name="line-962"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-963"></a><span class="p">};</span>
<a name="line-964"></a><span class="cp">#define SCSICMD_SYNCHRONIZECACHE10_SIZEOF 10</span>
<a name="line-965"></a>
<a name="line-966"></a><span class="k">struct</span> <span class="n">scsicmd_modeselect10_s</span>
<a name="line-967"></a><span class="p">{</span>
<a name="line-968"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0x55 */</span>
<a name="line-969"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_MODESELECT10_FLAGS_* */</span>
<a name="line-970"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>   <span class="cm">/* 2-6: Reserved */</span>
<a name="line-971"></a>  <span class="kt">uint8_t</span> <span class="n">parmlen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>    <span class="cm">/* 7-8: Parameter list length */</span>
<a name="line-972"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-973"></a><span class="p">};</span>
<a name="line-974"></a><span class="cp">#define SCSICMD_MODESELECT10_SIZEOF 10</span>
<a name="line-975"></a>
<a name="line-976"></a><span class="k">struct</span> <span class="n">scsiresp_modeparameterhdr10_s</span>
<a name="line-977"></a><span class="p">{</span>
<a name="line-978"></a>  <span class="kt">uint8_t</span> <span class="n">mdlen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>      <span class="cm">/* 0-1: Mode data length */</span>
<a name="line-979"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">type</span><span class="p">;</span>          <span class="cm">/* 2: Medium type */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-980"></a>  <span class="kt">uint8_t</span> <span class="n">param</span><span class="p">;</span>         <span class="cm">/* 3: Device-specific parameter */</span>
<a name="line-981"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 4-5: reserved */</span>
<a name="line-982"></a>  <span class="kt">uint8_t</span> <span class="n">bdlen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>      <span class="cm">/* 6-7: Block descriptor length */</span>
<a name="line-983"></a><span class="p">};</span>
<a name="line-984"></a><span class="cp">#define SCSIRESP_MODEPARAMETERHDR10_SIZEOF 8</span>
<a name="line-985"></a>
<a name="line-986"></a><span class="k">struct</span> <span class="n">scsicmd_modesense10_s</span>
<a name="line-987"></a><span class="p">{</span>
<a name="line-988"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* O: 0x5a */</span>
<a name="line-989"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_MODESENSE10_FLAGS_* */</span>
<a name="line-990"></a>  <span class="kt">uint8_t</span> <span class="n">pcpgcode</span><span class="p">;</span>      <span class="cm">/* 2: Bits 6-7: PC, bits 0-5: page code */</span>
<a name="line-991"></a>  <span class="kt">uint8_t</span> <span class="n">subpgcode</span><span class="p">;</span>     <span class="cm">/* 3: subpage code */</span>
<a name="line-992"></a>  <span class="kt">uint8_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>   <span class="cm">/* 4-6: reserved */</span>
<a name="line-993"></a>  <span class="kt">uint8_t</span> <span class="n">alloclen</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* 7-8: Allocation length */</span>
<a name="line-994"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 9: Control */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-995"></a><span class="p">};</span>
<a name="line-996"></a><span class="cp">#define SCSICMD_MODESENSE10_SIZEOF 10</span>
<a name="line-997"></a>
<a name="line-998"></a><span class="k">struct</span> <span class="n">scsicmd_read12_s</span>
<a name="line-999"></a><span class="p">{</span>
<a name="line-1000"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0xa8 */</span>
<a name="line-1001"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_READ12FLAGS_* */</span>
<a name="line-1002"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical Block Address (LBA) */</span>
<a name="line-1003"></a>  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="cm">/* 6-9: Transfer length (in contiguous logical blocks) */</span>
<a name="line-1004"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 10: Bit 7: restricted; Bits 5-6: reserved; Bits 0-6: group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-1005"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 11: Control */</span>
<a name="line-1006"></a><span class="p">};</span>
<a name="line-1007"></a><span class="cp">#define SCSICMD_READ12_SIZEOF 12</span>
<a name="line-1008"></a>
<a name="line-1009"></a><span class="k">struct</span> <span class="n">scsicmd_write12_s</span>
<a name="line-1010"></a><span class="p">{</span>
<a name="line-1011"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0xaa */</span>
<a name="line-1012"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_WRITE12FLAGS_* */</span>
<a name="line-1013"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical Block Address (LBA) */</span>
<a name="line-1014"></a>  <span class="kt">uint8_t</span> <span class="n">xfrlen</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="cm">/* 6-9: Transfer length (in contiguous logical blocks) */</span>
<a name="line-1015"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 10: Bit 7: restricted; Bits 5-6: reserved; Bits 0-6: group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-1016"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 11: Control */</span>
<a name="line-1017"></a><span class="p">};</span>
<a name="line-1018"></a><span class="cp">#define SCSICMD_WRITE12_SIZEOF 12</span>
<a name="line-1019"></a>
<a name="line-1020"></a><span class="k">struct</span> <span class="n">scsicmd_verify12_s</span>
<a name="line-1021"></a><span class="p">{</span>
<a name="line-1022"></a>  <span class="kt">uint8_t</span> <span class="n">opcode</span><span class="p">;</span>        <span class="cm">/* 0: 0xaf */</span>
<a name="line-1023"></a>  <span class="kt">uint8_t</span> <span class="n">flags</span><span class="p">;</span>         <span class="cm">/* 1: See SCSICMD_VERIFY12_* definitions */</span>
<a name="line-1024"></a>  <span class="kt">uint8_t</span> <span class="n">lba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 2-5: Logical block address (LBA) */</span>
<a name="line-1025"></a>  <span class="kt">uint8_t</span> <span class="n">len</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="cm">/* 6-9: Verification length */</span>
<a name="line-1026"></a><span class="hll">  <span class="kt">uint8_t</span> <span class="n">groupno</span><span class="p">;</span>       <span class="cm">/* 10: Bit 7: restricted; Bits 5-6: Reserved, Bits 0-4: Group number */</span><span class="error2">&lt;--- Avoid laying out strings in memory directly before sensitive data</span>
</span><a name="line-1027"></a>  <span class="kt">uint8_t</span> <span class="n">control</span><span class="p">;</span>       <span class="cm">/* 11: Control */</span>
<a name="line-1028"></a><span class="p">};</span>
<a name="line-1029"></a><span class="cp">#define SCSICMD_VERIFY12_SIZEOF 12</span>
<a name="line-1030"></a>
<a name="line-1031"></a><span class="cp">#define SCSICMD_TESTUNITREADY8_SIZEOF 6</span>
<a name="line-1032"></a>
<a name="line-1033"></a><span class="cm">/****************************************************************************</span>
<a name="line-1034"></a><span class="cm"> * Public Functions</span>
<a name="line-1035"></a><span class="cm"> ****************************************************************************/</span>
<a name="line-1036"></a>
<a name="line-1037"></a><span class="cp">#undef EXTERN</span>
<a name="line-1038"></a><span class="cp">#if defined(__cplusplus)</span>
<a name="line-1039"></a><span class="cp">#define EXTERN extern &quot;C&quot;</span>
<a name="line-1040"></a><span class="k">extern</span> <span class="s">&quot;C&quot;</span>
<a name="line-1041"></a><span class="p">{</span>
<a name="line-1042"></a><span class="cp">#else</span>
<a name="line-1043"></a><span class="cp">#define EXTERN extern</span>
<a name="line-1044"></a><span class="cp">#endif</span>
<a name="line-1045"></a>
<a name="line-1046"></a><span class="cp">#undef EXTERN</span>
<a name="line-1047"></a><span class="cp">#if defined(__cplusplus)</span>
<a name="line-1048"></a><span class="p">}</span>
<a name="line-1049"></a><span class="cp">#endif</span>
<a name="line-1050"></a>
<a name="line-1051"></a><span class="cp">#endif </span><span class="cm">/* __INCLUDE_NUTTX_SCSI_H */</span><span class="cp"></span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.1 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
